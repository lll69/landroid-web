(()=>{var t={604:(t,e,s)=>{var i;!function(){"use strict";var n={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function a(t){return function(t,e){var s,i,o,r,h,l,c,d,p,u=1,f=t.length,g="";for(i=0;i<f;i++)if("string"==typeof t[i])g+=t[i];else if("object"==typeof t[i]){if((r=t[i]).keys)for(s=e[u],o=0;o<r.keys.length;o++){if(null==s)throw new Error(a('[sprintf] Cannot access property "%s" of undefined value "%s"',r.keys[o],r.keys[o-1]));s=s[r.keys[o]]}else s=r.param_no?e[r.param_no]:e[u++];if(n.not_type.test(r.type)&&n.not_primitive.test(r.type)&&s instanceof Function&&(s=s()),n.numeric_arg.test(r.type)&&"number"!=typeof s&&isNaN(s))throw new TypeError(a("[sprintf] expecting number but found %T",s));switch(n.number.test(r.type)&&(d=s>=0),r.type){case"b":s=parseInt(s,10).toString(2);break;case"c":s=String.fromCharCode(parseInt(s,10));break;case"d":case"i":s=parseInt(s,10);break;case"j":s=JSON.stringify(s,null,r.width?parseInt(r.width):0);break;case"e":s=r.precision?parseFloat(s).toExponential(r.precision):parseFloat(s).toExponential();break;case"f":s=r.precision?parseFloat(s).toFixed(r.precision):parseFloat(s);break;case"g":s=r.precision?String(Number(s.toPrecision(r.precision))):parseFloat(s);break;case"o":s=(parseInt(s,10)>>>0).toString(8);break;case"s":s=String(s),s=r.precision?s.substring(0,r.precision):s;break;case"t":s=String(!!s),s=r.precision?s.substring(0,r.precision):s;break;case"T":s=Object.prototype.toString.call(s).slice(8,-1).toLowerCase(),s=r.precision?s.substring(0,r.precision):s;break;case"u":s=parseInt(s,10)>>>0;break;case"v":s=s.valueOf(),s=r.precision?s.substring(0,r.precision):s;break;case"x":s=(parseInt(s,10)>>>0).toString(16);break;case"X":s=(parseInt(s,10)>>>0).toString(16).toUpperCase()}n.json.test(r.type)?g+=s:(!n.number.test(r.type)||d&&!r.sign?p="":(p=d?"+":"-",s=s.toString().replace(n.sign,"")),l=r.pad_char?"0"===r.pad_char?"0":r.pad_char.charAt(1):" ",c=r.width-(p+s).length,h=r.width&&c>0?l.repeat(c):"",g+=r.align?p+s+h:"0"===l?p+h+s:h+p+s)}return g}(function(t){if(r[t])return r[t];for(var e,s=t,i=[],a=0;s;){if(null!==(e=n.text.exec(s)))i.push(e[0]);else if(null!==(e=n.modulo.exec(s)))i.push("%");else{if(null===(e=n.placeholder.exec(s)))throw new SyntaxError("[sprintf] unexpected placeholder");if(e[2]){a|=1;var o=[],h=e[2],l=[];if(null===(l=n.key.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(o.push(l[1]);""!==(h=h.substring(l[0].length));)if(null!==(l=n.key_access.exec(h)))o.push(l[1]);else{if(null===(l=n.index_access.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");o.push(l[1])}e[2]=o}else a|=2;if(3===a)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");i.push({placeholder:e[0],param_no:e[1],keys:e[2],sign:e[3],pad_char:e[4],align:e[5],width:e[6],precision:e[7],type:e[8]})}s=s.substring(e[0].length)}return r[t]=i}(t),arguments)}function o(t,e){return a.apply(null,[t].concat(e||[]))}var r=Object.create(null);e.sprintf=a,e.vsprintf=o,"undefined"!=typeof window&&(window.sprintf=a,window.vsprintf=o,void 0===(i=function(){return{sprintf:a,vsprintf:o}}.call(e,s,e,t))||(t.exports=i))}()}},e={};function s(i){var n=e[i];if(void 0!==n)return n.exports;var a=e[i]={exports:{}};return t[i](a,a.exports,s),a.exports}(()=>{"use strict";const t=[];let e=!0;function i(t){e=t}const n=1/2**32;class a{float(t=1){return this.int()*n*t}probability(t){return this.float()<t}norm(t=1){return 2*(this.int()*n-.5)*t}normMinMax(t,e){const s=this.minmax(t,e);return this.float()<.5?s:-s}minmax(t,e){return this.float()*(e-t)+t}minmaxInt(t,e){const s=(0|e)-(t|=0);return s?t+this.int()%s:t}minmaxUint(t,e){const s=(e>>>0)-(t>>>=0);return s?t+this.int()%s:t}}const o=new class extends a{constructor(t){super(),this.rnd=t}float(t=1){return this.rnd()*t}norm(t=1){return 2*(this.rnd()-.5)*t}int(){return 4294967296*this.rnd()>>>0}}(Math.random);var r=s(604);class h{constructor(t){this.elementData=Array(t),this.length=0,this.head=0}incrementHead(){this.head++,this.head>=this.elementData.length&&(this.head-=this.elementData.length)}ensureCapacity(t){t<=this.elementData.length||(this.elementData.length=t)}size(){return this.length}removeFirst(){if(0===this.length)throw new Error("Deque is empty");const t=this.elementData[this.head];return this.elementData[this.head]=void 0,this.incrementHead(),this.length-=1,t}addLast(t){var e,s,i;this.ensureCapacity(this.length+1),this.elementData[(e=this.length,s=this.head,i=this.elementData.length,e+s>=i?e+s-i:e+s)]=t,this.length++}forEach(t){const e=this.elementData,s=e.length,i=this.length;let n=this.head;for(let a=0;a<i;a++)t(e[n++],a),n>=s&&(n-=s)}forEachReversed(t){const e=this.elementData,s=e.length,i=this.length;let n=this.head+i-1;n>=s&&(n-=s);for(let a=i-1;a>=0;a--)t(e[n--],a),n<0&&(n+=s)}}function l(t,e,s){return(1-s)*t+s*e}function c(t,e,s){return t<e?e:t>s?s:t}function d(t,e){return function(t,e){return t>>>32-e&-e>>31}(t.intSigned(),e)}class p extends a{constructor(t,e){if(super(),this.buf=new Int32Array(6),this.buf[0]=0|t,this.buf[1]=0|e,this.buf[2]=0,this.buf[3]=0,this.buf[4]=~t,this.buf[5]=t<<10^e>>>4,0===(this.buf[0]|this.buf[1]|this.buf[2]|this.buf[3]|this.buf[4]))throw new Error("Initial state must have at least one non-zero element.");for(let t=0;t<64;t++)this.intSigned()}intSigned(){const t=this.buf;let e=t[0];e^=e>>>2,t[0]=t[1],t[1]=t[2],t[2]=t[3];const s=t[4];return t[3]=s,e=e^e<<1^s^s<<4,t[4]=e,e+(0|(t[5]+=362437))|0}int(){return this.intSigned()>>>0}minmaxInt(t,e){if(e<=t)throw new Error("Random range is empty: ["+t+", "+e+").");const s=e-t|0;if(s>0||-2147483648===s){if((s&-s)===s)return t+d(this,(i=s,31-Math.clz32(i)))|0;{let e,i;do{i=this.intSigned()>>>1,e=i%s}while((i-e+(s-1)|0)<0);return t+e|0}}for(;;){const s=this.intSigned();if(t<=s&&s<e)return s}var i}float(t=1){return d(this,24)/(1<<24)*t}}class u{constructor(t,e){this.x=t,this.y=e}copy(){return new u(this.x,this.y)}str(){return(0,r.sprintf)("<%+7.0f,%+7.0f>",this.x,this.y)}mag(){const t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}distance(t){const e=this.x-t.x,s=this.y-t.y;return Math.sqrt(e*e+s*s)}angle(){return Math.atan2(this.y,this.x)}product(t){return new u(this.x*t,this.y*t)}static Zero(){return new u(0,0)}addSelf(t){return this.x+=t.x,this.y+=t.y,this}productSelf(t){return this.x*=t,this.y*=t,this}}function f(t,e){t.x=e.x,t.y=e.y}function g(t,e){return Math.atan2(t.y-e.y,t.x-e.x)}function m(t,e,s){return t.x=s*Math.cos(e),t.y=s*Math.sin(e),t}function y(t,e,s){return t.x+=s*Math.cos(e),t.y+=s*Math.sin(e),t}class x{constructor(t="Unknown"){this.pos=u.Zero(),this.opos=u.Zero(),this.velocity=u.Zero(),this.mass=0,this.angle=0,this.radius=0,this.collides=!0,this.oangle=0,this.name=t}getOmega(){return this.angle-this.oangle}setOmega(t){this.oangle=this.angle-t}update(t,e){e<=0||(f(this.opos,this.pos),this.pos.x+=this.velocity.x*e,this.pos.y+=this.velocity.y*e)}postUpdate(t,e){e<=0||(this.velocity.x=(this.pos.x-this.opos.x)/e,this.velocity.y=(this.pos.y-this.opos.y)/e)}}class w{constructor(t){this.list=new Set,this.softness=0,this.radius=t}toString(){return"Container("+this.radius+")"}add(t){this.list.add(t)}remove(t){this.list.delete(t)}solve(t,e){this.list.forEach(t=>{if(t.pos.mag()+t.radius>this.radius){const e=t.pos.angle(),s=this.radius-t.radius,i=s*Math.cos(e),n=s*Math.sin(e);t.pos.x=t.pos.x*this.softness+i*(1-this.softness),t.pos.y=t.pos.y*this.softness+n*(1-this.softness)}})}}class v{constructor(t){this.wallClockMillis=0,this.now=0,this.dt=0,this.entities=new Set,this.constraints=new Set,this.randomSeed=t,this.rng=o,this.rngForInit=function(t){const e=Number(0xffffffffn&t),s=Number(t>>32n&0xffffffffn);return new p(e,s)}(t)}addEntity(t){this.entities.add(t)}removeEntity(t){this.entities.delete(t)}addConstraint(t){this.constraints.add(t)}removeConstraint(t){this.constraints.delete(t)}updateAll(t,e){e.forEach(e=>e.update(this,t))}solveAll(t,e){e.forEach(e=>e.solve(this,t))}postUpdateAll(t,e){e.forEach(e=>e.postUpdate(this,t))}step(t){const e=0===this.wallClockMillis;if(this.dt=(t-this.wallClockMillis)/1e3*1,this.wallClockMillis=t,e||this.dt>1)return;this.now+=this.dt;const s=this.entities,i=this.constraints;this.updateAll(this.dt,s),this.solveAll(this.dt,i),this.postUpdateAll(this.dt,s)}}class b{constructor(t){this.items=t,this.remaining=Array.from(t),this.next=t.length}pull(t){return this.next>=this.remaining.length&&(function(t,e){for(let s=t.length-1;s>=1;s--){let i=e.minmaxInt(0,s+1),n=t[s];t[s]=t[i],t[i]=n}}(this.remaining,t),this.next=0),this.remaining[this.next++]}}class E{constructor(t){this.pairs=t;let e=0;for(let s=0,i=t.length;s<i;s++)e+=t[s][0];this.total=e}roll(t){let e=t.minmax(0,this.total);const s=this.pairs,i=s.length;for(let t=0;t<i;t++)if(e-=s[t][0],e<0)return s[t][1];return s[i-1][1]}}function S(t,e){return e[t.minmaxInt(0,e.length)]}class F extends x{constructor(t,e,s,i,n="#FFFFFF"){super(),this.atmosphere="",this.description="",this.flora="",this.fauna="",this.explored=!1,this.orbitCenter=t,this.radius=e,this.pos=s,this.speed=i,this.color=n,this.orbitRadius=s.distance(t),this.mass=Math.floor(4/3)*Math.PI*e*e*e*2.5}update(t,e){const s=g(this.pos,this.orbitCenter);m(this.velocity,s+Math.PI/2,this.speed),super.update(t,e)}postUpdate(t,e){const s=g(this.pos,this.orbitCenter);m(this.pos,s,this.orbitRadius),this.pos.x+=this.orbitCenter.x,this.pos.y+=this.orbitCenter.y,super.postUpdate(t,e)}}const I=Object.freeze([0,1,2,3,4,5,6]),M=Object.freeze(["O","B","A","F","G","K","M"]);class P extends F{constructor(t,e){super(u.Zero(),e,u.Zero(),0,function(t){switch(t){case 0:return"#6666FF";case 1:return"#CCCCFF";case 2:return"#EEEEFF";case 3:return"#FFFFFF";case 4:return"#FFFF66";case 5:return"#FFCC33";case 6:return"#FF8800"}}(t)),this.anim=0,this.cls=t,this.mass=Math.floor(4/3)*Math.PI*Math.pow(e,3)*.5,this.collides=!1}update(t,e){this.anim+=e}}class k extends v{constructor(t,e){super(e),this.latestDiscovery=null,this.planets=[],this.follow=null,this.ringfence=new w(2e5),this.namer=t}initTest(){this.star=new P(2,8e3),this.star.name="TEST SYSTEM";for(let t=0;t<10;t++){const e=t/9,s=l(50,2e3,e),i=l(16e3,15e4,e),n=50*Math.sqrt(i*i*i/this.star.mass),a=2*Math.PI*i/n,o=new F(this.star.pos.copy(),s,m(u.Zero(),e*Math.PI*2,i).addSelf(this.star.pos),a,"#A7A7CA");console.log("Landroid","created planet",o,"with period",n,"and vel",a);const r=t+1;o.description="TEST PLANET #"+r,o.atmosphere="radius="+s,o.flora="mass="+o.mass,o.fauna="speed="+a,this.planets.push(o),this.addEntity(o)}this.planets.sort((t,e)=>t.pos.distance(this.star.pos)-e.pos.distance(this.star.pos)),this.planets.forEach((t,e)=>t.name="TEST SYSTEM "+(e+1)),this.addEntity(this.star),this.ship=new D,m(this.ship.pos,Math.PI/4,16e3).addSelf(this.star.pos),this.ship.angle=0,this.addEntity(this.ship),this.ringfence.add(this.ship),this.addConstraint(this.ringfence),this.follow=this.ship}initRandom(){const t=this.namer.nameSystem(this.rngForInit);this.star=new P(S(this.rngForInit,I),this.rngForInit.minmax(1e3,8e3)),this.star.name=t;for(let t=0,e=this.rngForInit.minmaxInt(1,11);t<e;t++){const t=this.rngForInit.minmax(50,2e3),e=l(16e3,15e4,this.rngForInit.float()),s=50*Math.sqrt(e*e*e/this.star.mass),i=2*Math.PI*e/s,n=new F(this.star.pos,t,m(u.Zero(),this.rngForInit.float()*Math.PI*2,e).addSelf(this.star.pos),i,"#A7A7CA");console.log("Landroid","created planet",n,"with period",s,"and vel",i),n.description=this.namer.describePlanet(this.rngForInit),n.atmosphere=this.namer.describeAtmo(this.rngForInit),n.flora=this.namer.describeLife(this.rngForInit),n.fauna=this.namer.describeLife(this.rngForInit),this.planets.push(n),this.addEntity(n)}this.planets.sort((t,e)=>t.pos.distance(this.star.pos)-e.pos.distance(this.star.pos)),this.planets.forEach((e,s)=>e.name=t+" "+(s+1)),this.addEntity(this.star),this.ship=new D,m(this.ship.pos,this.rngForInit.float()*Math.PI*2,this.rngForInit.minmax(16e3,15e4)).addSelf(this.star.pos),this.ship.angle=this.rngForInit.float()*Math.PI*2,this.addEntity(this.ship),this.ringfence.add(this.ship),this.addConstraint(this.ringfence),this.follow=this.ship}updateAll(t,e){this.ship.transit=!1;const s=e=>{const s=e.pos.distance(this.ship.pos);s<e.radius?e instanceof P&&(this.ship.transit=!0):this.now>this.ship.launchClock+2&&y(this.ship.velocity,g(e.pos,this.ship.pos),.01*t*(this.ship.mass*e.mass)/(s*s))};this.planets.forEach(s),s(this.star),super.updateAll(t,e)}closestPlanet(){const t=Array.from(this.planets);return t.push(this.star),t.map(t=>[t.pos,t]).sort((t,e)=>t[0].distance(this.ship.pos)-e[0].distance(this.ship.pos))[0][1]}closestPlanetForZoom(){const t=Array.from(this.planets);return t.push(this.star),t.map(t=>[t.pos,t]).sort((t,e)=>t[0].distance(this.ship.pos)-1.2*t[1].radius-(e[0].distance(this.ship.pos)-1.2*e[1].radius))[0][1]}solveAll(t,e){if(null===this.ship.landing){const t=this.closestPlanet();if(t.collides){const e=this.ship.pos.distance(t.pos)-this.ship.radius-t.radius,s=g(this.ship.pos,t.pos);if(e<0)if(this.ship.velocity.distance(t.velocity),Math.abs(this.ship.angle-s)<Math.PI/4){const e=new T(this.ship,t,s);this.ship.landing=e,f(this.ship.velocity,t.velocity),this.addConstraint(e),t.explored=!0,this.latestDiscovery=t}else{const i=m(u.Zero(),s,t.radius).addSelf(t.pos);m(this.ship.pos,s,t.radius+this.ship.radius-e).addSelf(t.pos);for(let t=1;t<=10;t++){const t=new L(this.rng.minmax(.5,2),!1,0,C.DOT,"#FFFFFF",1);m(t.pos,this.rng.minmax(0,2*Math.PI),this.rng.minmax(.1,.5)).addSelf(i),f(t.opos,t.pos),m(t.velocity,this.rng.minmax(0,2*Math.PI),this.rng.minmax(.1,.5)),t.velocity.x+=.8*this.ship.velocity.x,t.velocity.y+=.8*this.ship.velocity.y,this.addEntity(t)}}}}super.solveAll(t,e)}postUpdateAll(t,e){super.postUpdateAll(t,e),e.forEach(t=>{t.canBeRemoved&&t.canBeRemoved()&&e.delete(t)})}}class T{constructor(t,e,s){this.ship=t,this.planet=e,this.angle=s,this.landingVector=m(u.Zero(),s,t.radius+e.radius)}solve(t,e){null!==this.ship&&(this.ship.pos.x=0*this.ship.pos.x+1*(this.planet.pos.x+this.landingVector.x),this.ship.pos.y=0*this.ship.pos.y+1*(this.planet.pos.y+this.landingVector.y),this.ship.angle=this.angle)}}var C;!function(t){t[t.LINE=0]="LINE",t[t.LINE_ABSOLUTE=1]="LINE_ABSOLUTE",t[t.DOT=2]="DOT",t[t.DOT_ABSOLUTE=3]="DOT_ABSOLUTE",t[t.RING=4]="RING"}(C||(C={}));class L extends x{constructor(t,e=!1,s=0,i=C.LINE,n="#888888",a=2){super(),this.lifetime=t,this.collides=e,this.mass=s,this.style=i,this.color=n,this.size=a}update(t,e){super.update(t,e),this.lifetime-=e}canBeRemoved(){return this.lifetime<0}postUpdate(t,e){}}class A{constructor(){this.positions=new h(1e4),this.angles=new h(1e4)}add(t,e,s){this.positions.size()>=9999&&(this.positions.removeFirst(),this.angles.removeFirst(),this.positions.removeFirst(),this.angles.removeFirst()),this.positions.addLast(new u(t,e)),this.angles.addLast(s)}}class D extends x{constructor(){super(),this.thrust=u.Zero(),this.launchClock=0,this.transit=!1,this.track=new A,this.landing=null,this.mass=10,this.radius=12}update(t,e){const s=this.thrust.mag();if(s>0){let i=1e3*e;i*=c(s,0,1),null===this.landing||(0===this.launchClock&&(this.launchClock=t.now+1),t.now>this.launchClock?(t.removeConstraint(this.landing),this.landing=null):i=0),y(this.velocity,this.angle,i)}else 0!==this.launchClock&&(this.launchClock=0);this.velocity.mag()>5e3&&m(this.velocity,this.velocity.angle(),5e3),super.update(t,e)}postUpdate(t,e){super.postUpdate(t,e),this.track.add(this.pos.x,this.pos.y,this.angle);const s=this.thrust.mag();if(t.rng.float()<s){const i=new L(t.rng.minmax(.5,1),!0,1,C.RING,"#FFFFFF40",3);f(i.pos,this.pos),f(i.opos,this.opos),f(i.velocity,this.velocity),y(i.velocity,this.angle+t.rng.minmax(-.2,.2),-1e3*s*10*e),t.addEntity(i)}}}class R{constructor(){this.planetDescriptors=new b(["earthy","swamp","frozen","grassy","arid","crowded","ancient","lively","homey","modern","boring","compact","expensive","polluted","rusty","sandy","undulating","verdant","tessellated","hollow","scalding","hemispherical","oblong","oblate","vacuum","high-pressure","low-pressure","plastic","metallic","burned-out","bucolic"]),this.lifeDescriptors=new b(["aggressive","passive-aggressive","shy","timid","nasty","brutish","short","absent","teen-aged","confused","transparent","cubic","quadratic","higher-order","huge","tall","wary","loud","yodeling","purring","slender","cats","adorable","eclectic","electric","microscopic","trunkless","myriad","cantankerous","gargantuan","contagious","fungal","cattywampus","spatchcocked","rotisserie","farm-to-table","organic","synthetic","unfocused","focused","capitalist","communal","bossy","malicious","compliant","psychic","oblivious","passive","bonsai"]),this.anyDescriptors=new b(["silly","dangerous","vast","invisible","superfluous","superconducting","superior","alien","phantom","friendly","peaceful","lonely","uncomfortable","charming","fractal","imaginary","forgotten","tardy","gassy","fungible","bespoke","artisanal","exceptional","puffy","rusty","fresh","crusty","glossy","lovely","processed","macabre","reticulated","shocking","void","undefined","gothic","beige","mid","milquetoast","melancholy","unnerving","cheery","vibrant","heliotrope","psychedelic","nondescript","indescribable","tubular","toroidal","voxellated","low-poly","low-carb","100% cotton","synthetic","boot-cut","bell-bottom","bumpy","fluffy","sous-vide","tepid","upcycled","sous-vide","bedazzled","ancient","inexplicable","sparkling","still","lemon-scented","eccentric","tilted","pungent","pine-scented","corduroy","overengineered","bioengineered","impossible"]),this.atmoDescriptors=new b(["toxic","breathable","radioactive","clear","calm","peaceful","vacuum","stormy","freezing","burning","humid","tropical","cloudy","obscured","damp","dank","clammy","frozen","contaminated","temperate","moist","minty","relaxed","skunky","breezy","soup"]),this.planetTypes=new b(["planet","planetoid","moon","moonlet","centaur","asteroid","space garbage","detritus","satellite","core","giant","body","slab","rock","husk","planemo","object","planetesimal","exoplanet","ploonet"]),this.constellations=new b(["Aries","Taurus","Gemini","Cancer","Leo","Virgo","Libra","Scorpio","Sagittarius","Capricorn","Aquarius","Pisces","Andromeda","Cygnus","Draco","Alcor","Calamari","Cuckoo","Neko","Monoceros","Norma","Abnorma","Morel","Redlands","Cupcake","Donut","Eclair","Froyo","Gingerbread","Honeycomb","Icecreamsandwich","Jellybean","Kitkat","Lollipop","Marshmallow","Nougat","Oreo","Pie","Quincetart","Redvelvetcake","Snowcone","Tiramisu","Upsidedowncake","Vanillaicecream","Android","Binder","Campanile","Dread"]),this.constellationsRare=new b(["Jandycane","Zombiegingerbread","Astro","Bender","Flan","Untitled-1","Expedit","Petit Four","Worcester","Xylophone","Yellowpeep","Zebraball","Hutton","Klang","Frogblast","Exo","Keylimepie","Nat","Nrp"]),this.suffixes=new b(["Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega","Prime","Secundo","Major","Minor","Diminished","Augmented","Ultima","Penultima","Mid","Proxima","Novis","Plus"]),this.suffixesRare=new b(["Serif","Sans","Oblique","Grotesque","Handtooled","III “Trey”","Alfredo","2.0","(Final)","(Final (Final))","(Draft)","Con Carne"]),this.planetTable=new E([[.75,this.planetDescriptors],[.25,this.anyDescriptors]]),this.lifeTable=new E([[.75,this.lifeDescriptors],[.25,this.anyDescriptors]]),this.constellationsTable=new E([[.05,this.constellationsRare],[.95,this.constellations]]),this.suffixesTable=new E([[.05,this.suffixesRare],[.95,this.suffixes]]),this.atmoTable=new E([[.75,this.atmoDescriptors],[.25,this.anyDescriptors]]),this.delimiterTable=new E([[15," "],[3,"-"],[1,"_"],[1,"/"],[1,"."],[1,"*"],[1,"^"],[1,"#"],[.1,"(^*!%@##!!"]])}describePlanet(t){return this.planetTable.roll(t).pull(t)+" "+this.planetTypes.pull(t)}describeLife(t){return this.lifeTable.roll(t).pull(t)}nameSystem(t){let e=this.constellationsTable.roll(t).pull(t);return t.float()<=.75&&(e+=this.delimiterTable.roll(t),e+=this.suffixesTable.roll(t).pull(t),t.float()<=.05&&(e+=" ",e+=this.suffixesRare.pull(t))),t.float()<=.3&&(e+=this.delimiterTable.roll(t),e+=String.fromCharCode(65+t.minmaxInt(0,26)),t.float()<=.05&&(e+=this.delimiterTable.roll(t))),t.float()<=.3&&(e+=this.delimiterTable.roll(t),e+=t.minmaxInt(2,5039)),e}describeAtmo(t){return this.atmoTable.roll(t).pull(t)}}class z extends R{constructor(){super(...arguments),this.activities=new b(["refueling","sightseeing","vacationing","luncheoning","recharging","taking up space","reticulating space splines","using facilities","spelunking","repairing","herding {fauna}","taming {fauna}","breeding {fauna}","singing lullabies to {fauna}","singing lullabies to {flora}","singing lullabies to the {planet}","gardening {flora}","collecting {flora}","surveying the {planet}","mapping the {planet}","breathing {atmo}","reprocessing {atmo}","bottling {atmo}"]),this.floraGenericPlurals=new b(["flora","plants","flowers","trees","mosses","specimens","life","cells"]),this.faunaGenericPlurals=new b(["fauna","animals","locals","creatures","critters","wildlife","specimens","life","cells"]),this.atmoGenericPlurals=new b(["air","atmosphere","clouds","atmo","gases"]),this.TEMPLATE_REGEX=/(flora|fauna|planet|atmo)/}floraPlural(t){return this.floraGenericPlurals.pull(t)}faunaPlural(t){return this.faunaGenericPlurals.pull(t)}atmoPlural(t){return this.atmoGenericPlurals.pull(t)}describeActivity(t,e){return this.activities.pull(t).replace(this.TEMPLATE_REGEX,(s,i)=>{switch(i){case"flora":return(e?e.flora:"SOME")+" "+this.floraPlural(t);case"fauna":return(e?e.fauna:"SOME")+" "+this.faunaPlural(t);case"atmo":return(e?e.atmosphere:"SOME")+" "+this.atmoPlural(t);case"planet":return e?e.description:"SOME BODY";default:return"unknown template tag: "+i}}).toUpperCase()}}function O(t,e,s,i){const n=new Path2D;n.moveTo(t+s,i);const a=2*Math.PI/e;for(let o=1;o<e;o++)n.lineTo(t*Math.cos(a*o)+s,t*Math.sin(a*o)+i);return n.closePath(),n}function N(t,e,s){const i=new Path2D,n=2*Math.PI/s;i.moveTo(t,0),i.lineTo(e*Math.cos(.5*n),e*Math.sin(.5*n));for(let a=1;a<s;a++)i.lineTo(t*Math.cos(n*a),t*Math.sin(n*a)),i.lineTo(e*Math.cos(n*(a+.5)),e*Math.sin(n*(a+.5)));return i.closePath(),i}const U=t=>new Path2D(t);class B{constructor(t){this.lifetime=t}update(t){this.lifetime-=t}canBeRemoved(){return this.lifetime<0}}const _=x.prototype.update;class G extends T{constructor(t,e,s,i){super(t,e,s),this.text=i,this.fuse=new B(900)}solve(t,s){super.solve(t,s),e&&this.fuse.update(s)}canBeRemoved(){return e&&this.fuse.canBeRemoved()}}class q extends D{constructor(){super(...arguments),this.autopilot=null}update(t,e){const s=this.thrust.mag();if(s>0){let i=1e3*e;i*=c(s,0,1),null!==this.landing&&(0===this.launchClock&&(this.launchClock=t.now+1),t.now>this.launchClock?(this.landing.ship=null,this.landing=null):i=0),y(this.velocity,this.angle,i)}else 0!==this.launchClock&&(this.launchClock=0);this.velocity.mag()>5e3&&m(this.velocity,this.velocity.angle(),5e3),_.call(this,t,e)}}const Z=U("\nM11.853 0\nC11.853 -4.418 8.374 -8 4.083 -8\nL-5.5 -8\nC-6.328 -8 -7 -7.328 -7 -6.5\nC-7 -5.672 -6.328 -5 -5.5 -5\nL-2.917 -5\nC-1.26 -5 0.083 -3.657 0.083 -2\nL0.083 2\nC0.083 3.657 -1.26 5 -2.917 5\nL-5.5 5\nC-6.328 5 -7 5.672 -7 6.5\nC-7 7.328 -6.328 8 -5.5 8\nL4.083 8\nC8.374 8 11.853 4.418 11.853 0\nZ\n"),W=O(-3,3,-4,0);class Y{constructor(){this.containerDash=[0,0]}drawUniverse(t){t.constraints.forEach(t=>{t instanceof T?this.drawLanding(t):t instanceof w&&this.drawContainer(t)}),this.drawStar(t.star),t.entities.forEach(e=>{e!==t.ship&&e!==t.star&&(e instanceof D?this.drawSpacecraft(e):e instanceof L?this.drawSpark(e):e instanceof F&&this.drawPlanet(e))}),this.drawSpacecraft(t.ship)}drawContainer(t){const e=this.context,s=this.helper,i=this.containerDash;i[0]=i[1]=8/this.zoom,e.setLineDash(i),s.drawCircle("#800000",1/this.zoom,0,0,t.radius),s.clearLineDash()}drawGravitationalField(t){const e=this.helper;for(let s=0;s<8;s++){const i=l(200,.01,s/8),n=Math.sqrt(.01*t.mass*10/i);e.drawCircle("rgba(255,0,0,"+l(.5,.1,s/8)+")",2/this.zoom,t.pos.x,t.pos.y,n)}}drawPlanet(t){this.context;const e=this.helper;e.drawCircle("#00FFFF80",1/this.zoom,t.orbitCenter.x,t.orbitCenter.y,t.pos.distance(t.orbitCenter)),this.drawGravitationalField(t),e.fillCircle("#16161D",t.pos.x,t.pos.y,t.radius),e.drawCircle(t.color,2/this.zoom,t.pos.x,t.pos.y,t.radius)}drawStar(t){const e=this.context,s=this.helper,i=s.x,n=s.y;s.x-=t.pos.x,s.y-=t.pos.y,e.save(),e.translate(t.pos.x,t.pos.y),s.fillCircle(t.color,0,0,t.radius),this.drawGravitationalField(t),e.save(),e.rotate(t.anim/23*Math.PI*2),e.strokeStyle=t.color,e.lineWidth=3/this.zoom,e.lineJoin="round",e.stroke(N(t.radius+80,t.radius+250,31)),e.restore(),e.rotate(t.anim/-19*Math.PI*2),e.strokeStyle=t.color,e.lineWidth=3/this.zoom,e.lineJoin="round",e.stroke(N(t.radius+20,t.radius+200,32)),e.restore(),s.x=i,s.y=n}drawSpacecraft(t){const e=this.context,s=this.helper,i=s.x,n=s.y;s.x-=t.pos.x,s.y-=t.pos.y,e.save(),e.translate(t.pos.x,t.pos.y),e.rotate(t.angle),e.fillStyle="#16161D",e.fill(Z),e.strokeStyle=t.transit?"#000000":"#FFFFFF",e.lineWidth=2/this.zoom,e.stroke(Z),0===t.thrust.x&&0===t.thrust.y||(e.strokeStyle="#FF8800",e.lineJoin="round",e.lineWidth=2/this.zoom,e.stroke(W)),e.restore(),s.x=i,s.y=n,this.drawTrack(t.track)}drawLanding(t){const e=this.context,s=m(u.Zero(),t.angle,t.planet.radius).addSelf(t.planet.pos);e.strokeStyle="#FF0000",e.lineWidth=1/this.zoom,e.beginPath(),e.moveTo(s.x-5,s.y-5),e.lineTo(s.x+5,s.y+5),e.stroke(),e.beginPath(),e.moveTo(s.x+5,s.y-5),e.lineTo(s.x-5,s.y+5),e.stroke()}drawSpark(t){if(t.lifetime<0)return;const e=this.context;switch(t.style){case C.LINE:0===t.opos.x&&0===t.opos.y||(e.strokeStyle=t.color,e.lineWidth=t.size,e.beginPath(),e.moveTo(t.opos.x,t.opos.y),e.lineTo(t.pos.x,t.pos.y),e.stroke());break;case C.LINE_ABSOLUTE:0===t.opos.x&&0===t.opos.y||(e.strokeStyle=t.color,e.lineWidth=t.size/this.zoom,e.beginPath(),e.moveTo(t.opos.x,t.opos.y),e.lineTo(t.pos.x,t.pos.y),e.stroke());break;case C.DOT:e.fillStyle=t.color,e.beginPath(),e.arc(t.pos.x,t.pos.y,t.size,0,2*Math.PI),e.fill();break;case C.DOT_ABSOLUTE:e.fillStyle=t.color,e.beginPath(),e.arc(t.pos.x/this.zoom,t.pos.y/this.zoom,t.size,0,2*Math.PI),e.fill();break;case C.RING:e.strokeStyle=t.color,e.lineWidth=1/this.zoom,e.beginPath(),e.arc(t.pos.x,t.pos.y,t.size,0,2*Math.PI),e.stroke()}}drawTrack(t){this.context;const e=this.helper;{const s=1/this.zoom;let i,n;t.positions.forEach((t,a)=>{0!==a&&e.drawLine("#00FF00",s,i,n,t.x,t.y),i=t.x,n=t.y})}}}class j extends k{constructor(t,e){super(t,e),this.triggerDraw=1/0,this.realDt=1/0}simulateFrame(t){const e=this.triggerDraw,s=t-e;if(this.triggerDraw=t,this.realDt=s,s>24){const t=Math.ceil(s/24);for(let i=1;i<=t;i++)this.step(e+s/t*i)}else this.step(t)}}const X=U("\nM-7   -6.5\nl-3.5  0\nl-1   -2\nl 0    4\nl 1   -2\nZ\nM-7    6.5\nl-3.5  0\nl-1   -2\nl 0    4\nl 1   -2\nZ\n"),V=O(-3,3,-5,0),H=v.prototype.solveAll;class J extends Y{drawUniverse(t){t.constraints.forEach(t=>{t instanceof T?this.drawLanding(t):t instanceof w&&this.drawContainer(t)}),this.drawStar(t.star),t.entities.forEach(e=>{e!==t.star&&(e instanceof L?this.drawSpark(e):e instanceof F&&this.drawPlanet(e))});const e=t.ship,s=e.autopilot;null!==s&&s.enabled&&this.drawAutopilot(s),this.drawSpacecraft(e)}drawSpacecraft(t){const e=this.context,s=this.helper,i=s.x,n=s.y;s.x-=t.pos.x,s.y-=t.pos.y,e.save(),e.translate(t.pos.x,t.pos.y),e.rotate(t.angle),null!==t.landing&&(e.strokeStyle="#CCCCCC",e.lineWidth=2/this.zoom,e.stroke(X)),e.fillStyle="#16161D",e.fill(Z),e.strokeStyle=t.transit?"#000000":"#FFFFFF",e.lineWidth=2/this.zoom,e.stroke(Z),0===t.thrust.x&&0===t.thrust.y||(e.strokeStyle="#FF8800",e.lineJoin="round",e.lineWidth=2/this.zoom,e.stroke(V)),e.restore(),s.x=i,s.y=n,this.drawTrack(t.track)}drawLanding(t){if(e){const e=this.context,s=m(u.Zero(),t.angle,t.planet.radius).addSelf(t.planet.pos),i=2/this.zoom,n=80;e.save(),e.translate(s.x,s.y),e.rotate(t.angle),e.strokeStyle="#C6FF00",e.lineWidth=i,e.beginPath(),e.moveTo(0,0),e.lineTo(n,0),e.lineTo(.875*n,.25*n),e.lineTo(.75*n,0),e.stroke(),e.restore()}}drawAutopilot(t){if(null!==t.target){const e=t.target,s="#4285F480",i=this.context,n=this.helper,a=this.zoom,o=n.x,r=n.y;n.x-=e.pos.x,n.y-=e.pos.y,i.save(),i.translate(e.pos.x,e.pos.y),i.rotate(2*t.universe.now*Math.PI/10),i.strokeStyle=s,i.lineWidth=1/a,function(t,e){t.beginPath(),t.moveTo(e,0);const s=2*Math.PI/15;for(let i=1;i<15;i++)t.lineTo(e*Math.cos(s*i),e*Math.sin(s*i));t.closePath(),t.stroke()}(i,e.radius+t.brakingDistance),i.globalAlpha=.25,n.drawCircle(s,t.landingAltitude,0,0,e.radius+t.landingAltitude/2),i.globalAlpha=1,i.restore(),n.x=o,n.y=r,n.drawLine(s,1/a,t.ship.pos.x,t.ship.pos.y,t.leadingPos.x,t.leadingPos.y),n.drawCircle(s,1/a,t.leadingPos.x,t.leadingPos.y,5/a)}}}class K extends j{initTest(){this.star=new P(2,8e3),this.star.name="TEST SYSTEM";for(let t=0;t<10;t++){const e=t/9,s=l(50,2e3,e),i=l(16e3,15e4,e),n=50*Math.sqrt(i*i*i/this.star.mass),a=2*Math.PI*i/n,o=new F(this.star.pos.copy(),s,m(u.Zero(),e*Math.PI*2,i).addSelf(this.star.pos),a,"#A7A7CA");console.log("Landroid","created planet",o,"with period",n,"and vel",a);const r=t+1;o.description="TEST PLANET #"+r,o.atmosphere="radius="+s,o.flora="mass="+o.mass,o.fauna="speed="+a,this.planets.push(o),this.addEntity(o)}this.planets.sort((t,e)=>t.pos.distance(this.star.pos)-e.pos.distance(this.star.pos)),this.planets.forEach((t,e)=>t.name="TEST SYSTEM "+(e+1)),this.addEntity(this.star),this.ship=new q,m(this.ship.pos,Math.PI/4,16e3).addSelf(this.star.pos),this.ship.angle=0,this.addEntity(this.ship),this.ringfence.add(this.ship),this.addConstraint(this.ringfence),this.follow=this.ship}initRandom(){const t=this.namer.nameSystem(this.rngForInit);this.star=new P(S(this.rngForInit,I),this.rngForInit.minmax(1e3,8e3)),this.star.name=t;for(let t=0,e=this.rngForInit.minmaxInt(1,11);t<e;t++){const t=this.rngForInit.minmax(50,2e3),e=l(16e3,15e4,this.rngForInit.float()),s=50*Math.sqrt(e*e*e/this.star.mass),i=2*Math.PI*e/s,n=new F(this.star.pos,t,m(u.Zero(),this.rngForInit.float()*Math.PI*2,e).addSelf(this.star.pos),i,"#A7A7CA");console.log("Landroid","created planet",n,"with period",s,"and vel",i),n.description=this.namer.describePlanet(this.rngForInit),n.atmosphere=this.namer.describeAtmo(this.rngForInit),n.flora=this.namer.describeLife(this.rngForInit),n.fauna=this.namer.describeLife(this.rngForInit),this.planets.push(n),this.addEntity(n)}this.planets.sort((t,e)=>t.pos.distance(this.star.pos)-e.pos.distance(this.star.pos)),this.planets.forEach((e,s)=>e.name=t+" "+(s+1)),this.addEntity(this.star),this.ship=new q,m(this.ship.pos,this.rngForInit.float()*Math.PI*2,this.rngForInit.minmax(16e3,15e4)).addSelf(this.star.pos),this.ship.angle=this.rngForInit.float()*Math.PI*2,this.addEntity(this.ship),this.ringfence.add(this.ship),this.addConstraint(this.ringfence),this.follow=this.ship}solveAll(t,e){if(null===this.ship.landing){const t=this.closestPlanet();if(t.collides){const e=this.ship.pos.distance(t.pos)-this.ship.radius-t.radius,s=g(this.ship.pos,t.pos);if(e<0)if(this.ship.velocity.distance(t.velocity),Math.abs(this.ship.angle-s)<Math.PI/4){const e=new G(this.ship,t,s,this.namer.describeActivity(this.rng,t));this.ship.landing=e,f(this.ship.velocity,t.velocity),this.addConstraint(e),t.explored=!0,this.latestDiscovery=t}else{const i=m(u.Zero(),s,t.radius).addSelf(t.pos);m(this.ship.pos,s,t.radius+this.ship.radius-e).addSelf(t.pos);for(let t=1;t<=10;t++){const t=new L(this.rng.minmax(.5,2),!1,0,C.DOT,"#FFFFFF",1);m(t.pos,this.rng.minmax(0,2*Math.PI),this.rng.minmax(.1,.5)).addSelf(i),f(t.opos,t.pos),m(t.velocity,this.rng.minmax(0,2*Math.PI),this.rng.minmax(.1,.5)),t.velocity.x+=.8*this.ship.velocity.x,t.velocity.y+=.8*this.ship.velocity.y,this.addEntity(t)}}}}H.call(this,t,e)}}class ${getTelemetry(){return"---- AUTOPILOT ENGAGED ----\nTGT: "+(this.target&&this.target.name?this.target.name:"SELECTING...")+"\nEXE: "+this.strategy+(this.debug.length>0?" ("+this.debug+")":"")}constructor(t,e){this.enabled=!1,this.target=null,this.landingAltitude=0,this.nextStrategyTime=0,this.brakingDistance=0,this.leadingPos=u.Zero(),this.leadingVector=u.Zero(),this.rng=o,this.strategy="NONE",this.debug="",this.ship=t,this.universe=e}update(t,e){if(!this.enabled)return;if(t.now<this.nextStrategyTime)return;const s=this.strategy;if(null!==this.ship.landing)null!==this.target?(this.strategy="LANDED",this.debug="",this.target=null,this.landingAltitude=0,this.nextStrategyTime=t.now+15):(m(this.ship.thrust,this.ship.angle,1),this.strategy="LAUNCHING",this.debug="",this.nextStrategyTime=t.now+5);else{if(null===this.target&&(this.target=this.universe.planets.sort((t,e)=>this.ship.pos.distance(t.pos)-this.ship.pos.distance(e.pos)).find(t=>!t.explored)||null,this.brakingDistance=0,null===this.target&&(this.target=S(this.rng,this.universe.planets))),null!==this.target){const e=this.ship.velocity,s=this.target.velocity,i=this.target.pos.x-this.ship.pos.x,n=this.target.pos.y-this.ship.pos.y,a=Math.sqrt(i*i+n*n),o=a-this.target.radius;this.landingAltitude=Math.min(this.target.radius,100);const h=e.x-s.x,l=e.y-s.y,c=(h*i+l*n)/a,d=Math.sqrt(h*h+l*l)*Math.sign(c),p=0!==d?o/d:1e3,u=5*(d>0?d:1e3);if(this.brakingDistance=function(t,e,s){return t+(e-t)*(1-Math.exp(5*-s))}(this.brakingDistance,u,t.dt),m(this.leadingPos,this.target.velocity.angle(),Math.min(o/2,this.target.velocity.mag())).addSelf(this.target.pos),this.leadingVector.x=this.leadingPos.x-this.ship.pos.x,this.leadingVector.y=this.leadingPos.y-this.ship.pos.y,o<this.landingAltitude)this.strategy="LANDING",this.ship.angle=g(this.ship.pos,this.target.pos),this.ship.thrust.x=this.ship.thrust.y=0;else if(d<0||o>this.brakingDistance)this.strategy="CHASING",this.ship.angle=this.leadingVector.angle(),m(this.ship.thrust,this.ship.angle,1);else{this.strategy="APPROACHING",this.ship.angle=this.ship.velocity.angle()+Math.PI;const t=d/p/1e3*.9;m(this.ship.thrust,this.ship.angle,t)}this.debug=(0,r.sprintf)("DV=%.0f D=%.0f T%+.1f",d,o,p)}this.strategy!==s&&(this.nextStrategyTime=t.now+.5)}}postUpdate(t,e){}}let Q=1,tt=5038n;const et=.00125;let st=!1,it=1;function nt(t){return t>=0||-9223372036854775808n===t?t:-t}function at(t){return t*window.devicePixelRatio}function ot(){return it}function rt(t){it=c(t,et,5)}function ht(t){Q=t}const lt=[];if("undefined"==typeof BigInt&&lt.push("BigInt"),void 0===String.prototype.matchAll&&lt.push("String.prototype.matchAll"),lt.length>0)throw alert("Your browser does not support the following features: "+lt+".\nThe app will exit now."),new Error("Unsupported features: "+lt);const ct=document.getElementById("canvasMain"),dt=ct.getContext("2d");let pt=!1;if(!dt)throw alert("Unable to get canvas 2d context.\nThe app will exit now."),new Error("Unable to get canvas 2d context");const ut=new class{constructor(t){this.ctx=t}clearLineDash(){this.ctx.setLineDash(t)}drawCircle(t,e,s,i,n){const a=this.x+this.width/2,o=this.y+this.height/2,r=s-a,h=i-o,l=this.radius;if(Math.sqrt(r*r+h*h)-n-e>l)return;if(Math.sqrt((s-a)*(s-a)+(i-o)*(i-o))+l+e<n)return;const c=this.ctx;c.strokeStyle=t,c.lineWidth=e,c.beginPath(),c.arc(s,i,n,0,2*Math.PI),c.stroke()}fillCircle(t,e,s,i){const n=e-(this.x+this.width/2),a=s-(this.y+this.height/2),o=this.radius;if(Math.sqrt(n*n+a*a)-i>o)return;const r=this.ctx;r.fillStyle=t,r.beginPath(),r.arc(e,s,i,0,2*Math.PI),r.fill()}drawLine(t,e,s,i,n,a){if(function(t,e,s,i,n,a){return(n-s)*(n-s)+(a-i)*(a-i)<1e-20?Math.sqrt((t-s)*(t-s)+(e-i)*(e-i)):Math.abs((n-s)*(i-e)-(s-t)*(a-i))/Math.sqrt((n-s)*(n-s)+(a-i)*(a-i))}(this.x+this.width/2,this.y+this.height/2,s,i,n,a)>this.radius+e)return;const o=this.ctx;o.strokeStyle=t,o.lineWidth=e,o.beginPath(),o.moveTo(s,i),o.lineTo(n,a),o.stroke()}}(dt),ft=document.getElementById("rightContainer");let gt=0;const mt=document.getElementById("zoomSelect");function yt(){const t=location.hash,e=t?new URLSearchParams(t.substring(1)):new URLSearchParams;switch(gt=mt.selectedIndex){case 0:e.set("zoom","fixed");break;case 1:e.set("zoom","dynamic");break;case 2:e.set("zoom","manual")}const s=e.toString();location.hash!==s&&(history.replaceState({},"","#"+e.toString()),xt())}function xt(){const t=location.hash,e=t?new URLSearchParams(t.substring(1)):new URLSearchParams,s=e.get("zoom");st="dynamic"===s,"dynamic"===s&&(gt=1),pt="manual"===s,pt&&(gt=2),pt||"dynamic"===s||(rt(1),gt=0),mt.removeEventListener("change",yt),mt.selectedIndex=gt,mt.addEventListener("change",yt);const n=e.get("seed");if(n)if("evergreen"===n)ht(2);else if("daily"===n)ht(1);else try{const t=9223372036854775807n,e=-9223372036854775808n;let s=BigInt(n);s>t&&(s=t),s<e&&(s=e),ht(0),function(t){tt=t}(s)}catch(t){console.log(t)}const a=e.get("flag");"true"===a||"1"===a?i(!0):"false"!==a&&"0"!==a||i(!1)}mt.addEventListener("change",yt),xt(),window.addEventListener("hashchange",xt);const wt=function(t,e,s,i){const n=new K(new z,function(){switch(Q){case 0:return nt(tt);case 1:return nt(BigInt(function(){let t=new Date;return 1e4*t.getFullYear()+100*t.getMonth()+t.getDate()}()));default:return nt((BigInt(o.int())<<32n|BigInt(o.int()))%10000000n)}}()),a=new J;n.initRandom();const h=function(t,e){let s=it,i=0,n=0;return(a,o)=>{const r=a.canvas.width,h=a.canvas.height;if(a.fillStyle="#16161D",a.fillRect(0,0,r,h),st){const e=t.closestPlanetForZoom(),i=Math.max(0,t.ship.pos.distance(e.pos)-1.2*e.radius);s=c(500/i,et,5)}else s=it;{const e=t.follow;null!==e?(i=-e.pos.x,n=-e.pos.y):i=n=0}const l=r/s,d=h/s,p=-i-.5*l,u=-n-.5*d,f=p+l,g=u+d,m=p+l/2,y=u+d/2;let x=1e3;const w=at(32);for(;x*s<w;)x*=10;a.save(),a.scale(s,s),a.translate(.5*r/s-m,.5*h/s-y),o.x=p,o.y=u,o.width=l,o.height=d,o.radius=Math.sqrt((l*l+d*d)/4);var v=Math.floor(p/x)*x;for(a.strokeStyle="#292936";v<f;)a.lineWidth=(v%(10*x)==0?3:1.5)/s,a.beginPath(),a.moveTo(v,u),a.lineTo(v,g),a.stroke(),v+=x;for(var b=Math.floor(u/x)*x;b<g;)a.lineWidth=(b%(10*x)==0?3:1.5)/s,a.beginPath(),a.moveTo(p,b),a.lineTo(f,b),a.stroke(),b+=x;e.zoom=s,e.context=a,e.helper=o,e.drawUniverse(t),a.restore()}}(n,a),l=at(50),d=at(100),p=function(t,e,s,i){let n,a,o,r,h=!1;return{pointerInput:function(t){if(h)if("touchend"===t.type||"touchcancel"===t.type||"pointerup"===t.type||"pointercancel"===t.type)h=!1,i(0,0),t.preventDefault();else if("touchmove"===t.type){const e=t.touches[0];o=e.clientX*window.devicePixelRatio,r=e.clientY*window.devicePixelRatio,i(o-n,r-a),t.preventDefault()}else"pointermove"===t.type?(o=t.clientX*window.devicePixelRatio,r=t.clientY*window.devicePixelRatio,i(o-n,r-a),t.preventDefault()):"touchstart"===t.type&&t.touches.length>1&&(h=!1,i(0,0));else if("touchstart"===t.type){if(1===t.touches.length){const e=t.touches[0];n=o=e.clientX*window.devicePixelRatio,a=r=e.clientY*window.devicePixelRatio,h=!0,t.preventDefault()}}else"pointerdown"===t.type&&(n=o=t.clientX*window.devicePixelRatio,a=r=t.clientY*window.devicePixelRatio,h=!0,t.preventDefault(),t.target.setPointerCapture(t.pointerId))},draw:(s,i)=>{if(h){const h=o-n,l=r-a,c=Math.min(e,Math.sqrt(h*h+l*l)),d=Math.max(t,c),p=Math.atan2(l,h);if(s.strokeStyle="#00FF00",s.lineWidth=2,c<t){const t=window.visualViewport&&window.visualViewport.scale||1;s.setLineDash([t,2*t])}s.beginPath(),s.arc(n,a,d,0,2*Math.PI),s.stroke(),i.clearLineDash(),s.beginPath(),s.moveTo(n,a),s.lineTo(n+Math.cos(p)*c,a+Math.sin(p)*c),s.stroke()}}}}(l,d,0,(t,e)=>{if(n.follow instanceof D){const i=n.follow;if(0===t&&0===e)i.thrust.x=0,i.thrust.y=0;else{const n=Math.atan2(e,t);i.angle=n;const a=Math.sqrt(t*t+e*e);a<l?(i.thrust.x=0,i.thrust.y=0):m(i.thrust,n,c((a-(s=l))/(d-s),0,1))}}var s}),u=new $(n.ship,n),f=p.draw,g=function(t,e,s,i,n,a){let o=!1,h=!1,l=-1;const c=document.createTextNode("");s.appendChild(c);const d=document.createTextNode("");i.appendChild(d);const p=document.createTextNode("");a.appendChild(p);let u=0,f=0,g=0;return s=>{if(-1===l)return void(l=s);let a=s-l;h||0===t.realDt||(a>=2e3?(i.hidden=!1,i.style.opacity=1,h=!0):a>1e3&&(i.hidden=!1,i.style.opacity=Math.random()*(s-1e3)/1e3)),o||0===t.realDt||(a>=3e3?(n.hidden=!1,n.style.opacity=String(1),o=!0):a>2e3&&(n.hidden=!1,n.style.opacity=String(Math.random()*(s-2e3)/1e3))),e.enabled?p.textContent=e.getTelemetry():p.textContent="",s-f>=1e3&&(g=1e3*u/(s-f),f=s,u=0),u++;const m=t.star,y=t.planets.filter(t=>t.explored).map(t=>"  BODY: "+t.name+"\n  TYPE: "+t.description+"\n  ATMO: "+t.atmosphere+"\n FAUNA: "+t.fauna+"\n FLORA: "+t.flora+"\n"),x="  STAR: "+m.name+" (UDC-"+t.randomSeed%100000n+")\n CLASS: "+M[m.cls]+"\nRADIUS: "+Math.floor(m.radius)+"\n"+(0,r.sprintf)("  MASS: %.3e\n",m.mass)+"BODIES: "+y.length+" / "+t.planets.length+"\n   FPS: "+(0===t.realDt?"Paused":g.toFixed(1))+"\n  vFPS: "+(0===t.dt?"Paused":(1/t.dt).toFixed(0))+"\n\n"+y.join("\n");c.textContent=x;const w=t.ship,v=t.closestPlanet(),b=Math.floor(v.pos.distance(w.pos));let E="";null!==w.landing?(E+="LND: "+w.landing.planet.name,E+="\nJOB: "+w.landing.text):b<1e4&&(E+="ALT: "+b),0===w.thrust.x&&0===w.thrust.y||(E.length>0&&(E+="\n"),E+="THR: "+(100*w.thrust.mag()).toFixed(0)+"%"),E.length>0&&(E+="\n"),E+="POS: "+w.pos.str()+"\n",E+="VEL: "+w.velocity.mag().toFixed(0),d.textContent=E}}(n,u,t,e,s,i),y=n.ship;return y.autopilot=u,n.addEntity(u),{pointerInput:p.pointerInput,setAutopilot:function(t){u.enabled&&!t&&(y.thrust.x=y.thrust.y=0),u.enabled=t},draw:(t,e,s)=>{n.simulateFrame(t),h(e,s),f(e,s),g(t)}}}(document.getElementById("topText"),document.getElementById("bottomText"),document.getElementById("topContainer"),document.getElementById("autopilotText")),vt=wt.pointerInput,bt=wt.draw,Et=wt.setAutopilot;let St=null,Ft=0,It=0,Mt=!1;function Pt(t){bt((Mt?It:t)-Ft,dt,ut),St=requestAnimationFrame(Pt)}function kt(){const t=ct.getBoundingClientRect();ct.width=Math.round(t.width*window.devicePixelRatio),ct.height=Math.round(t.height*window.devicePixelRatio)}function Tt(){ct.addEventListener("touchstart",vt),ct.addEventListener("touchmove",vt),ct.addEventListener("touchend",vt),ct.addEventListener("touchcancel",vt),ct.addEventListener("pointerdown",vt),ct.addEventListener("pointermove",vt),ct.addEventListener("pointerup",vt),ct.addEventListener("pointercancel",vt)}document.getElementById("loading").hidden=!0,ct.hidden=!1,Tt();let Ct=!1,Lt=0,At=0,Dt=-1;function Rt(){mt.blur(),clearInterval(Dt),ft.classList.remove("controls-show")}function zt(){ft.classList.add("controls-show"),clearInterval(Dt)}function Ot(){zt(),Dt=setInterval(Rt,2e3)}function Nt(t){if(Ct){if("touchstart"===t.type)2!==t.touches.length&&(Ct=!1,Ot());else if("touchend"===t.type||"touchcancel"===t.type)Ct=!1,Ot();else if("touchmove"===t.type){const e=t.touches[1].clientX-t.touches[0].clientX,s=t.touches[1].clientY-t.touches[0].clientY,i=Math.sqrt(e*e+s*s);pt&&rt(Lt*i/At),t.preventDefault()}}else if("touchstart"===t.type&&2===t.touches.length){Ct=!0;const e=t.touches[1].clientX-t.touches[0].clientX,s=t.touches[1].clientY-t.touches[0].clientY;Lt=ot(),At=Math.sqrt(e*e+s*s),t.preventDefault(),zt()}}ct.addEventListener("touchstart",Nt),ct.addEventListener("touchmove",Nt),ct.addEventListener("touchend",Nt),ct.addEventListener("touchcancel",Nt),document.addEventListener("wheel",function(t){pt&&(t.preventDefault(),rt(ot()*(1-t.deltaY/1e3))),Ot()});const Ut=document.getElementById("autopilotCheck");Ut.addEventListener("change",function(){Et(Ut.checked),Ot()});const Bt=document.getElementById("pauseCheck");Bt.addEventListener("change",function(){Bt.checked?(It=performance.now(),Mt=!0,ct.removeEventListener("touchstart",vt),ct.removeEventListener("touchmove",vt),ct.removeEventListener("touchend",vt),ct.removeEventListener("touchcancel",vt),ct.removeEventListener("pointerdown",vt),ct.removeEventListener("pointermove",vt),ct.removeEventListener("pointerup",vt),ct.removeEventListener("pointercancel",vt)):(Ft+=performance.now()-It,Mt=!1,Tt()),Ot()}),mt.addEventListener("focus",Ot),mt.addEventListener("blur",Ot),mt.addEventListener("change",Ot),setTimeout(function(){kt(),new ResizeObserver(kt).observe(ct),confirm("This project is licensed under the Apache License 2.0.\nThis project is not affiliated with Android or Google.\n\nClick OK to continue running this app, or click Cancel to close this app.")&&(Ot(),setTimeout(()=>St=requestAnimationFrame(Pt),0))},0)})()})();