(()=>{var t={604:(t,e,s)=>{var i;!function(){"use strict";var n={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function o(t){return function(t,e){var s,i,r,a,h,l,c,d,p,u=1,f=t.length,m="";for(i=0;i<f;i++)if("string"==typeof t[i])m+=t[i];else if("object"==typeof t[i]){if((a=t[i]).keys)for(s=e[u],r=0;r<a.keys.length;r++){if(null==s)throw new Error(o('[sprintf] Cannot access property "%s" of undefined value "%s"',a.keys[r],a.keys[r-1]));s=s[a.keys[r]]}else s=a.param_no?e[a.param_no]:e[u++];if(n.not_type.test(a.type)&&n.not_primitive.test(a.type)&&s instanceof Function&&(s=s()),n.numeric_arg.test(a.type)&&"number"!=typeof s&&isNaN(s))throw new TypeError(o("[sprintf] expecting number but found %T",s));switch(n.number.test(a.type)&&(d=s>=0),a.type){case"b":s=parseInt(s,10).toString(2);break;case"c":s=String.fromCharCode(parseInt(s,10));break;case"d":case"i":s=parseInt(s,10);break;case"j":s=JSON.stringify(s,null,a.width?parseInt(a.width):0);break;case"e":s=a.precision?parseFloat(s).toExponential(a.precision):parseFloat(s).toExponential();break;case"f":s=a.precision?parseFloat(s).toFixed(a.precision):parseFloat(s);break;case"g":s=a.precision?String(Number(s.toPrecision(a.precision))):parseFloat(s);break;case"o":s=(parseInt(s,10)>>>0).toString(8);break;case"s":s=String(s),s=a.precision?s.substring(0,a.precision):s;break;case"t":s=String(!!s),s=a.precision?s.substring(0,a.precision):s;break;case"T":s=Object.prototype.toString.call(s).slice(8,-1).toLowerCase(),s=a.precision?s.substring(0,a.precision):s;break;case"u":s=parseInt(s,10)>>>0;break;case"v":s=s.valueOf(),s=a.precision?s.substring(0,a.precision):s;break;case"x":s=(parseInt(s,10)>>>0).toString(16);break;case"X":s=(parseInt(s,10)>>>0).toString(16).toUpperCase()}n.json.test(a.type)?m+=s:(!n.number.test(a.type)||d&&!a.sign?p="":(p=d?"+":"-",s=s.toString().replace(n.sign,"")),l=a.pad_char?"0"===a.pad_char?"0":a.pad_char.charAt(1):" ",c=a.width-(p+s).length,h=a.width&&c>0?l.repeat(c):"",m+=a.align?p+s+h:"0"===l?p+h+s:h+p+s)}return m}(function(t){if(a[t])return a[t];for(var e,s=t,i=[],o=0;s;){if(null!==(e=n.text.exec(s)))i.push(e[0]);else if(null!==(e=n.modulo.exec(s)))i.push("%");else{if(null===(e=n.placeholder.exec(s)))throw new SyntaxError("[sprintf] unexpected placeholder");if(e[2]){o|=1;var r=[],h=e[2],l=[];if(null===(l=n.key.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(r.push(l[1]);""!==(h=h.substring(l[0].length));)if(null!==(l=n.key_access.exec(h)))r.push(l[1]);else{if(null===(l=n.index_access.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");r.push(l[1])}e[2]=r}else o|=2;if(3===o)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");i.push({placeholder:e[0],param_no:e[1],keys:e[2],sign:e[3],pad_char:e[4],align:e[5],width:e[6],precision:e[7],type:e[8]})}s=s.substring(e[0].length)}return a[t]=i}(t),arguments)}function r(t,e){return o.apply(null,[t].concat(e||[]))}var a=Object.create(null);e.sprintf=o,e.vsprintf=r,"undefined"!=typeof window&&(window.sprintf=o,window.vsprintf=r,void 0===(i=function(){return{sprintf:o,vsprintf:r}}.call(e,s,e,t))||(t.exports=i))}()}},e={};function s(i){var n=e[i];if(void 0!==n)return n.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,s),o.exports}(()=>{"use strict";const t=[],e=1/2**32;class i{float(t=1){return this.int()*e*t}probability(t){return this.float()<t}norm(t=1){return 2*(this.int()*e-.5)*t}normMinMax(t,e){const s=this.minmax(t,e);return this.float()<.5?s:-s}minmax(t,e){return this.float()*(e-t)+t}minmaxInt(t,e){const s=(0|e)-(t|=0);return s?t+this.int()%s:t}minmaxUint(t,e){const s=(e>>>0)-(t>>>=0);return s?t+this.int()%s:t}}const n=new class extends i{constructor(t){super(),this.rnd=t}float(t=1){return this.rnd()*t}norm(t=1){return 2*(this.rnd()-.5)*t}int(){return 4294967296*this.rnd()>>>0}}(Math.random);var o=s(604);class r{constructor(t){this.elementData=Array(t),this.length=0,this.head=0}incrementHead(){this.head++,this.head>=this.elementData.length&&(this.head-=this.elementData.length)}ensureCapacity(t){t<=this.elementData.length||(this.elementData.length=t)}size(){return this.length}removeFirst(){if(0===this.length)throw new Error("Deque is empty");const t=this.elementData[this.head];return this.elementData[this.head]=void 0,this.incrementHead(),this.length-=1,t}addLast(t){var e,s,i;this.ensureCapacity(this.length+1),this.elementData[(e=this.length,s=this.head,i=this.elementData.length,e+s>=i?e+s-i:e+s)]=t,this.length++}forEach(t){const e=this.elementData,s=e.length,i=this.length;let n=this.head;for(let o=0;o<i;o++)t(e[n++],o),n>=s&&(n-=s)}forEachReversed(t){const e=this.elementData,s=e.length,i=this.length;let n=this.head+i-1;n>=s&&(n-=s);for(let o=i-1;o>=0;o--)t(e[n--],o),n<0&&(n+=s)}}function a(t,e,s){return(1-s)*t+s*e}function h(t,e,s){return t<e?e:t>s?s:t}function l(t,e){return function(t,e){return t>>>32-e&-e>>31}(t.intSigned(),e)}class c extends i{constructor(t,e){if(super(),this.buf=new Int32Array(6),this.buf[0]=0|t,this.buf[1]=0|e,this.buf[2]=0,this.buf[3]=0,this.buf[4]=~t,this.buf[5]=t<<10^e>>>4,0===(this.buf[0]|this.buf[1]|this.buf[2]|this.buf[3]|this.buf[4]))throw new Error("Initial state must have at least one non-zero element.");for(let t=0;t<64;t++)this.intSigned()}intSigned(){const t=this.buf;let e=t[0];e^=e>>>2,t[0]=t[1],t[1]=t[2],t[2]=t[3];const s=t[4];return t[3]=s,e=e^e<<1^s^s<<4,t[4]=e,e+(0|(t[5]+=362437))|0}int(){return this.intSigned()>>>0}minmaxInt(t,e){if(e<=t)throw new Error("Random range is empty: ["+t+", "+e+").");const s=e-t|0;if(s>0||-2147483648===s){if((s&-s)===s)return t+l(this,(i=s,31-Math.clz32(i)))|0;{let e,i;do{i=this.intSigned()>>>1,e=i%s}while((i-e+(s-1)|0)<0);return t+e|0}}for(;;){const s=this.intSigned();if(t<=s&&s<e)return s}var i}float(t=1){return l(this,24)/(1<<24)*t}}class d{constructor(t,e){this.x=t,this.y=e}copy(){return new d(this.x,this.y)}str(){return(0,o.sprintf)("<%+7.0f,%+7.0f>",this.x,this.y)}mag(){const t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}distance(t){const e=this.x-t.x,s=this.y-t.y;return Math.sqrt(e*e+s*s)}angle(){return Math.atan2(this.y,this.x)}product(t){return new d(this.x*t,this.y*t)}static Zero(){return new d(0,0)}addSelf(t){return this.x+=t.x,this.y+=t.y,this}productSelf(t){return this.x*=t,this.y*=t,this}}function p(t,e){t.x=e.x,t.y=e.y}function u(t,e){return Math.atan2(t.y-e.y,t.x-e.x)}function f(t,e,s){return t.x=s*Math.cos(e),t.y=s*Math.sin(e),t}function m(t,e,s){return t.x+=s*Math.cos(e),t.y+=s*Math.sin(e),t}class g{constructor(t="Unknown"){this.pos=d.Zero(),this.opos=d.Zero(),this.velocity=d.Zero(),this.mass=0,this.angle=0,this.radius=0,this.collides=!0,this.oangle=0,this.name=t}getOmega(){return this.angle-this.oangle}setOmega(t){this.oangle=this.angle-t}update(t,e){e<=0||(p(this.opos,this.pos),this.pos.x+=this.velocity.x*e,this.pos.y+=this.velocity.y*e)}postUpdate(t,e){e<=0||(this.velocity.x=(this.pos.x-this.opos.x)/e,this.velocity.y=(this.pos.y-this.opos.y)/e)}}class y{constructor(t){this.list=new Set,this.softness=0,this.radius=t}toString(){return"Container("+this.radius+")"}add(t){this.list.add(t)}remove(t){this.list.delete(t)}solve(t,e){this.list.forEach(t=>{if(t.pos.mag()+t.radius>this.radius){const e=t.pos.angle(),s=this.radius-t.radius,i=s*Math.cos(e),n=s*Math.sin(e);t.pos.x=t.pos.x*this.softness+i*(1-this.softness),t.pos.y=t.pos.y*this.softness+n*(1-this.softness)}})}}class w{constructor(t){this.wallClockMillis=0,this.now=0,this.dt=0,this.entities=new Set,this.constraints=new Set,this.randomSeed=t,this.rng=n,this.rngForInit=function(t){const e=Number(0xffffffffn&t),s=Number(t>>32n&0xffffffffn);return new c(e,s)}(t)}addEntity(t){this.entities.add(t)}removeEntity(t){this.entities.delete(t)}addConstraint(t){this.constraints.add(t)}removeConstraint(t){this.constraints.delete(t)}updateAll(t,e){e.forEach(e=>e.update(this,t))}solveAll(t,e){e.forEach(e=>e.solve(this,t))}postUpdateAll(t,e){e.forEach(e=>e.postUpdate(this,t))}step(t){const e=0===this.wallClockMillis;if(this.dt=(t-this.wallClockMillis)/1e3*1,this.wallClockMillis=t,e||this.dt>1)return;this.now+=this.dt;const s=this.entities,i=this.constraints;this.updateAll(this.dt,s),this.solveAll(this.dt,i),this.postUpdateAll(this.dt,s)}}class x{constructor(t){this.items=t,this.remaining=Array.from(t),this.next=t.length}pull(t){return this.next>=this.remaining.length&&(function(t,e){for(let s=t.length-1;s>=1;s--){let i=e.minmaxInt(0,s+1),n=t[s];t[s]=t[i],t[i]=n}}(this.remaining,t),this.next=0),this.remaining[this.next++]}}class v{constructor(t){this.pairs=t;let e=0;for(let s=0,i=t.length;s<i;s++)e+=t[s][0];this.total=e}roll(t){let e=t.minmax(0,this.total);const s=this.pairs,i=s.length;for(let t=0;t<i;t++)if(e-=s[t][0],e<0)return s[t][1];return s[i-1][1]}}class b extends g{constructor(t,e,s,i,n="#FFFFFF"){super(),this.atmosphere="",this.description="",this.flora="",this.fauna="",this.explored=!1,this.orbitCenter=t,this.radius=e,this.pos=s,this.speed=i,this.color=n,this.orbitRadius=s.distance(t),this.mass=Math.floor(4/3)*Math.PI*e*e*e*2.5}update(t,e){const s=u(this.pos,this.orbitCenter);f(this.velocity,s+Math.PI/2,this.speed),super.update(t,e)}postUpdate(t,e){const s=u(this.pos,this.orbitCenter);f(this.pos,s,this.orbitRadius),this.pos.x+=this.orbitCenter.x,this.pos.y+=this.orbitCenter.y,super.postUpdate(t,e)}}const F=Object.freeze([0,1,2,3,4,5,6]),S=Object.freeze(["O","B","A","F","G","K","M"]);class M extends b{constructor(t,e){super(d.Zero(),e,d.Zero(),0,function(t){switch(t){case 0:return"#6666FF";case 1:return"#CCCCFF";case 2:return"#EEEEFF";case 3:return"#FFFFFF";case 4:return"#FFFF66";case 5:return"#FFCC33";case 6:return"#FF8800"}}(t)),this.anim=0,this.cls=t,this.mass=Math.floor(4/3)*Math.PI*Math.pow(e,3)*.5,this.collides=!1}update(t,e){this.anim+=e}}class k extends w{constructor(t,e){super(e),this.latestDiscovery=null,this.planets=[],this.follow=null,this.ringfence=new y(2e5),this.namer=t}initTest(){this.star=new M(2,8e3),this.star.name="TEST SYSTEM";for(let t=0;t<10;t++){const e=t/9,s=a(50,2e3,e),i=a(16e3,15e4,e),n=50*Math.sqrt(i*i*i/this.star.mass),o=2*Math.PI*i/n,r=new b(this.star.pos.copy(),s,f(d.Zero(),e*Math.PI*2,i).addSelf(this.star.pos),o,"#A7A7CA");console.log("Landroid","created planet",r,"with period",n,"and vel",o);const h=t+1;r.description="TEST PLANET #"+h,r.atmosphere="radius="+s,r.flora="mass="+r.mass,r.fauna="speed="+o,this.planets.push(r),this.addEntity(r)}this.planets.sort((t,e)=>t.pos.distance(this.star.pos)-e.pos.distance(this.star.pos)),this.planets.forEach((t,e)=>t.name="TEST SYSTEM "+(e+1)),this.addEntity(this.star),this.ship=new P,f(this.ship.pos,Math.PI/4,16e3).addSelf(this.star.pos),this.ship.angle=0,this.addEntity(this.ship),this.ringfence.add(this.ship),this.addConstraint(this.ringfence),this.follow=this.ship}initRandom(){const t=this.namer.nameSystem(this.rngForInit);var e,s;this.star=new M((e=this.rngForInit,(s=F)[e.minmaxInt(0,s.length)]),this.rngForInit.minmax(1e3,8e3)),this.star.name=t;for(let t=0,e=this.rngForInit.minmaxInt(1,11);t<e;t++){const t=this.rngForInit.minmax(50,2e3),e=a(16e3,15e4,this.rngForInit.float()),s=50*Math.sqrt(e*e*e/this.star.mass),i=2*Math.PI*e/s,n=new b(this.star.pos,t,f(d.Zero(),this.rngForInit.float()*Math.PI*2,e).addSelf(this.star.pos),i,"#A7A7CA");console.log("Landroid","created planet",n,"with period",s,"and vel",i),n.description=this.namer.describePlanet(this.rngForInit),n.atmosphere=this.namer.describeAtmo(this.rngForInit),n.flora=this.namer.describeLife(this.rngForInit),n.fauna=this.namer.describeLife(this.rngForInit),this.planets.push(n),this.addEntity(n)}this.planets.sort((t,e)=>t.pos.distance(this.star.pos)-e.pos.distance(this.star.pos)),this.planets.forEach((e,s)=>e.name=t+" "+(s+1)),this.addEntity(this.star),this.ship=new P,f(this.ship.pos,this.rngForInit.float()*Math.PI*2,this.rngForInit.minmax(16e3,15e4)).addSelf(this.star.pos),this.ship.angle=this.rngForInit.float()*Math.PI*2,this.addEntity(this.ship),this.ringfence.add(this.ship),this.addConstraint(this.ringfence),this.follow=this.ship}updateAll(t,e){this.ship.transit=!1;const s=e=>{const s=e.pos.distance(this.ship.pos);s<e.radius?e instanceof M&&(this.ship.transit=!0):this.now>this.ship.launchClock+2&&m(this.ship.velocity,u(e.pos,this.ship.pos),.01*t*(this.ship.mass*e.mass)/(s*s))};this.planets.forEach(s),s(this.star),super.updateAll(t,e)}closestPlanet(){const t=Array.from(this.planets);return t.push(this.star),t.map(t=>[t.pos,t]).sort((t,e)=>t[0].distance(this.ship.pos)-e[0].distance(this.ship.pos))[0][1]}closestPlanetForZoom(){const t=Array.from(this.planets);return t.push(this.star),t.map(t=>[t.pos,t]).sort((t,e)=>t[0].distance(this.ship.pos)-1.2*t[1].radius-(e[0].distance(this.ship.pos)-1.2*e[1].radius))[0][1]}solveAll(t,e){if(null===this.ship.landing){const t=this.closestPlanet();if(t.collides){const e=this.ship.pos.distance(t.pos)-this.ship.radius-t.radius,s=u(this.ship.pos,t.pos);if(e<0)if(this.ship.velocity.distance(t.velocity),Math.abs(this.ship.angle-s)<Math.PI/4){const e=new T(this.ship,t,s);this.ship.landing=e,p(this.ship.velocity,t.velocity),this.addConstraint(e),t.explored=!0,this.latestDiscovery=t}else{const i=f(d.Zero(),s,t.radius).addSelf(t.pos);f(this.ship.pos,s,t.radius+this.ship.radius-e).addSelf(t.pos);for(let t=1;t<=10;t++){const t=new E(this.rng.minmax(.5,2),!1,0,I.DOT,"#FFFFFF",1);f(t.pos,this.rng.minmax(0,2*Math.PI),this.rng.minmax(.1,.5)).addSelf(i),p(t.opos,t.pos),f(t.velocity,this.rng.minmax(0,2*Math.PI),this.rng.minmax(.1,.5)),t.velocity.x+=.8*this.ship.velocity.x,t.velocity.y+=.8*this.ship.velocity.y,this.addEntity(t)}}}}super.solveAll(t,e)}postUpdateAll(t,e){super.postUpdateAll(t,e),e.forEach(t=>{t.canBeRemoved&&t.canBeRemoved()&&e.delete(t)})}}class T{constructor(t,e,s){this.ship=t,this.planet=e,this.angle=s,this.landingVector=f(d.Zero(),s,t.radius+e.radius)}solve(t,e){null!==this.ship&&(this.ship.pos.x=0*this.ship.pos.x+1*(this.planet.pos.x+this.landingVector.x),this.ship.pos.y=0*this.ship.pos.y+1*(this.planet.pos.y+this.landingVector.y),this.ship.angle=this.angle)}}var I;!function(t){t[t.LINE=0]="LINE",t[t.LINE_ABSOLUTE=1]="LINE_ABSOLUTE",t[t.DOT=2]="DOT",t[t.DOT_ABSOLUTE=3]="DOT_ABSOLUTE",t[t.RING=4]="RING"}(I||(I={}));class E extends g{constructor(t,e=!1,s=0,i=I.LINE,n="#888888",o=2){super(),this.lifetime=t,this.collides=e,this.mass=s,this.style=i,this.color=n,this.size=o}update(t,e){super.update(t,e),this.lifetime-=e}canBeRemoved(){return this.lifetime<0}postUpdate(t,e){}}class C{constructor(){this.positions=new r(1e4),this.angles=new r(1e4)}add(t,e,s){this.positions.size()>=9999&&(this.positions.removeFirst(),this.angles.removeFirst(),this.positions.removeFirst(),this.angles.removeFirst()),this.positions.addLast(new d(t,e)),this.angles.addLast(s)}}class P extends g{constructor(){super(),this.thrust=d.Zero(),this.launchClock=0,this.transit=!1,this.track=new C,this.landing=null,this.mass=10,this.radius=12}update(t,e){const s=this.thrust.mag();if(s>0){let i=1e3*e;i*=h(s,0,1),null===this.landing||(0===this.launchClock&&(this.launchClock=t.now+1),t.now>this.launchClock?(t.removeConstraint(this.landing),this.landing=null):i=0),m(this.velocity,this.angle,i)}else 0!==this.launchClock&&(this.launchClock=0);this.velocity.mag()>5e3&&f(this.velocity,this.velocity.angle(),5e3),super.update(t,e)}postUpdate(t,e){super.postUpdate(t,e),this.track.add(this.pos.x,this.pos.y,this.angle);const s=this.thrust.mag();if(t.rng.float()<s){const i=new E(t.rng.minmax(.5,1),!0,1,I.RING,"#FFFFFF40",3);p(i.pos,this.pos),p(i.opos,this.opos),p(i.velocity,this.velocity),m(i.velocity,this.angle+t.rng.minmax(-.2,.2),-1e3*s*10*e),t.addEntity(i)}}}function D(t,e,s){const i=new Path2D,n=2*Math.PI/s;i.moveTo(t,0),i.lineTo(e*Math.cos(.5*n),e*Math.sin(.5*n));for(let o=1;o<s;o++)i.lineTo(t*Math.cos(n*o),t*Math.sin(n*o)),i.lineTo(e*Math.cos(n*(o+.5)),e*Math.sin(n*(o+.5)));return i.closePath(),i}const L=new Path2D("\nM11.853 0\nC11.853 -4.418 8.374 -8 4.083 -8\nL-5.5 -8\nC-6.328 -8 -7 -7.328 -7 -6.5\nC-7 -5.672 -6.328 -5 -5.5 -5\nL-2.917 -5\nC-1.26 -5 0.083 -3.657 0.083 -2\nL0.083 2\nC0.083 3.657 -1.26 5 -2.917 5\nL-5.5 5\nC-6.328 5 -7 5.672 -7 6.5\nC-7 7.328 -6.328 8 -5.5 8\nL4.083 8\nC8.374 8 11.853 4.418 11.853 0\nZ\n"),A=function(){const t=new Path2D;t.moveTo(-7,0);const e=2*Math.PI/3;for(let s=1;s<3;s++)t.lineTo(-3*Math.cos(e*s)-4,-3*Math.sin(e*s)+0);return t.closePath(),t}();class R{constructor(){this.containerDash=[0,0]}drawUniverse(t){t.constraints.forEach(t=>{t instanceof T?this.drawLanding(t):t instanceof y&&this.drawContainer(t)}),this.drawStar(t.star),t.entities.forEach(e=>{e!==t.ship&&e!==t.star&&(e instanceof P?this.drawSpacecraft(e):e instanceof E?this.drawSpark(e):e instanceof b&&this.drawPlanet(e))}),this.drawSpacecraft(t.ship)}drawContainer(t){const e=this.context,s=this.helper,i=this.containerDash;i[0]=i[1]=8/this.zoom,e.setLineDash(i),s.drawCircle("#800000",1/this.zoom,0,0,t.radius),s.clearLineDash()}drawGravitationalField(t){const e=this.helper;for(let s=0;s<8;s++){const i=a(200,.01,s/8),n=Math.sqrt(.01*t.mass*10/i);e.drawCircle("rgba(255,0,0,"+a(.5,.1,s/8)+")",2/this.zoom,t.pos.x,t.pos.y,n)}}drawPlanet(t){this.context;const e=this.helper;e.drawCircle("#00FFFF80",1/this.zoom,t.orbitCenter.x,t.orbitCenter.y,t.pos.distance(t.orbitCenter)),this.drawGravitationalField(t),e.fillCircle("#16161D",t.pos.x,t.pos.y,t.radius),e.drawCircle(t.color,2/this.zoom,t.pos.x,t.pos.y,t.radius)}drawStar(t){const e=this.context,s=this.helper,i=s.x,n=s.y;s.x-=t.pos.x,s.y-=t.pos.y,e.save(),e.translate(t.pos.x,t.pos.y),s.fillCircle(t.color,0,0,t.radius),this.drawGravitationalField(t),e.save(),e.rotate(t.anim/23*Math.PI*2),e.strokeStyle=t.color,e.lineWidth=3/this.zoom,e.lineJoin="round",e.stroke(D(t.radius+80,t.radius+250,31)),e.restore(),e.rotate(t.anim/-19*Math.PI*2),e.strokeStyle=t.color,e.lineWidth=3/this.zoom,e.lineJoin="round",e.stroke(D(t.radius+20,t.radius+200,32)),e.restore(),s.x=i,s.y=n}drawSpacecraft(t){const e=this.context,s=this.helper,i=s.x,n=s.y;s.x-=t.pos.x,s.y-=t.pos.y,e.save(),e.translate(t.pos.x,t.pos.y),e.rotate(t.angle),e.fillStyle="#16161D",e.fill(L),e.strokeStyle=t.transit?"#000000":"#FFFFFF",e.lineWidth=2/this.zoom,e.stroke(L),0===t.thrust.x&&0===t.thrust.y||(e.strokeStyle="#FF8800",e.lineJoin="round",e.lineWidth=2/this.zoom,e.stroke(A)),e.restore(),s.x=i,s.y=n,this.drawTrack(t.track)}drawLanding(t){const e=this.context,s=f(d.Zero(),t.angle,t.planet.radius).addSelf(t.planet.pos);e.strokeStyle="#FF0000",e.lineWidth=1/this.zoom,e.beginPath(),e.moveTo(s.x-5,s.y-5),e.lineTo(s.x+5,s.y+5),e.stroke(),e.beginPath(),e.moveTo(s.x+5,s.y-5),e.lineTo(s.x-5,s.y+5),e.stroke()}drawSpark(t){if(t.lifetime<0)return;const e=this.context;switch(t.style){case I.LINE:0===t.opos.x&&0===t.opos.y||(e.strokeStyle=t.color,e.lineWidth=t.size,e.beginPath(),e.moveTo(t.opos.x,t.opos.y),e.lineTo(t.pos.x,t.pos.y),e.stroke());break;case I.LINE_ABSOLUTE:0===t.opos.x&&0===t.opos.y||(e.strokeStyle=t.color,e.lineWidth=t.size/this.zoom,e.beginPath(),e.moveTo(t.opos.x,t.opos.y),e.lineTo(t.pos.x,t.pos.y),e.stroke());break;case I.DOT:e.fillStyle=t.color,e.beginPath(),e.arc(t.pos.x,t.pos.y,t.size,0,2*Math.PI),e.fill();break;case I.DOT_ABSOLUTE:e.fillStyle=t.color,e.beginPath(),e.arc(t.pos.x/this.zoom,t.pos.y/this.zoom,t.size,0,2*Math.PI),e.fill();break;case I.RING:e.strokeStyle=t.color,e.lineWidth=1/this.zoom,e.beginPath(),e.arc(t.pos.x,t.pos.y,t.size,0,2*Math.PI),e.stroke()}}drawTrack(t){this.context;const e=this.helper;{const s=1/this.zoom;let i,n;t.positions.forEach((t,o)=>{0!==o&&e.drawLine("#00FF00",s,i,n,t.x,t.y),i=t.x,n=t.y})}}}class z extends k{constructor(t,e){super(t,e),this.triggerDraw=1/0,this.realDt=1/0}simulateFrame(t){const e=this.triggerDraw,s=t-e;if(this.triggerDraw=t,this.realDt=s,s>24){const t=Math.ceil(s/24);for(let i=1;i<=t;i++)this.step(e+s/t*i)}else this.step(t)}}class U{constructor(){this.planetDescriptors=new x(["earthy","swamp","frozen","grassy","arid","crowded","ancient","lively","homey","modern","boring","compact","expensive","polluted","rusty","sandy","undulating","verdant","tessellated","hollow","scalding","hemispherical","oblong","oblate","vacuum","high-pressure","low-pressure","plastic","metallic","burned-out","bucolic"]),this.lifeDescriptors=new x(["aggressive","passive-aggressive","shy","timid","nasty","brutish","short","absent","teen-aged","confused","transparent","cubic","quadratic","higher-order","huge","tall","wary","loud","yodeling","purring","slender","cats","adorable","eclectic","electric","microscopic","trunkless","myriad","cantankerous","gargantuan","contagious","fungal","cattywampus","spatchcocked","rotisserie","farm-to-table","organic","synthetic","unfocused","focused","capitalist","communal","bossy","malicious","compliant","psychic","oblivious","passive","bonsai"]),this.anyDescriptors=new x(["silly","dangerous","vast","invisible","superfluous","superconducting","superior","alien","phantom","friendly","peaceful","lonely","uncomfortable","charming","fractal","imaginary","forgotten","tardy","gassy","fungible","bespoke","artisanal","exceptional","puffy","rusty","fresh","crusty","glossy","lovely","processed","macabre","reticulated","shocking","void","undefined","gothic","beige","mid","milquetoast","melancholy","unnerving","cheery","vibrant","heliotrope","psychedelic","nondescript","indescribable","tubular","toroidal","voxellated","low-poly","low-carb","100% cotton","synthetic","boot-cut","bell-bottom","bumpy","fluffy","sous-vide","tepid","upcycled","sous-vide","bedazzled","ancient","inexplicable","sparkling","still","lemon-scented","eccentric","tilted","pungent","pine-scented","corduroy","overengineered","bioengineered","impossible"]),this.atmoDescriptors=new x(["toxic","breathable","radioactive","clear","calm","peaceful","vacuum","stormy","freezing","burning","humid","tropical","cloudy","obscured","damp","dank","clammy","frozen","contaminated","temperate","moist","minty","relaxed","skunky","breezy","soup"]),this.planetTypes=new x(["planet","planetoid","moon","moonlet","centaur","asteroid","space garbage","detritus","satellite","core","giant","body","slab","rock","husk","planemo","object","planetesimal","exoplanet","ploonet"]),this.constellations=new x(["Aries","Taurus","Gemini","Cancer","Leo","Virgo","Libra","Scorpio","Sagittarius","Capricorn","Aquarius","Pisces","Andromeda","Cygnus","Draco","Alcor","Calamari","Cuckoo","Neko","Monoceros","Norma","Abnorma","Morel","Redlands","Cupcake","Donut","Eclair","Froyo","Gingerbread","Honeycomb","Icecreamsandwich","Jellybean","Kitkat","Lollipop","Marshmallow","Nougat","Oreo","Pie","Quincetart","Redvelvetcake","Snowcone","Tiramisu","Upsidedowncake","Vanillaicecream","Android","Binder","Campanile","Dread"]),this.constellationsRare=new x(["Jandycane","Zombiegingerbread","Astro","Bender","Flan","Untitled-1","Expedit","Petit Four","Worcester","Xylophone","Yellowpeep","Zebraball","Hutton","Klang","Frogblast","Exo","Keylimepie","Nat","Nrp"]),this.suffixes=new x(["Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega","Prime","Secundo","Major","Minor","Diminished","Augmented","Ultima","Penultima","Mid","Proxima","Novis","Plus"]),this.suffixesRare=new x(["Serif","Sans","Oblique","Grotesque","Handtooled","III “Trey”","Alfredo","2.0","(Final)","(Final (Final))","(Draft)","Con Carne"]),this.planetTable=new v([[.75,this.planetDescriptors],[.25,this.anyDescriptors]]),this.lifeTable=new v([[.75,this.lifeDescriptors],[.25,this.anyDescriptors]]),this.constellationsTable=new v([[.05,this.constellationsRare],[.95,this.constellations]]),this.suffixesTable=new v([[.05,this.suffixesRare],[.95,this.suffixes]]),this.atmoTable=new v([[.75,this.atmoDescriptors],[.25,this.anyDescriptors]]),this.delimiterTable=new v([[15," "],[3,"-"],[1,"_"],[1,"/"],[1,"."],[1,"*"],[1,"^"],[1,"#"],[.1,"(^*!%@##!!"]])}describePlanet(t){return this.planetTable.roll(t).pull(t)+" "+this.planetTypes.pull(t)}describeLife(t){return this.lifeTable.roll(t).pull(t)}nameSystem(t){let e=this.constellationsTable.roll(t).pull(t);return t.float()<=.75&&(e+=this.delimiterTable.roll(t),e+=this.suffixesTable.roll(t).pull(t),t.float()<=.05&&(e+=" ",e+=this.suffixesRare.pull(t))),t.float()<=.3&&(e+=this.delimiterTable.roll(t),e+=String.fromCharCode(65+t.minmaxInt(0,26)),t.float()<=.05&&(e+=this.delimiterTable.roll(t))),t.float()<=.3&&(e+=this.delimiterTable.roll(t),e+=t.minmaxInt(2,5039)),e}describeAtmo(t){return this.atmoTable.roll(t).pull(t)}}let O=1,_=5038n;const N=.00125;let B=!1,q=1;function Z(t){return t>=0||-9223372036854775808n===t?t:-t}function j(t){return t*window.devicePixelRatio}function Y(){return q}function W(t){q=h(t,N,5)}function G(t){O=t}const X=[];if("undefined"==typeof BigInt&&X.push("BigInt"),void 0===String.prototype.matchAll&&X.push("String.prototype.matchAll"),X.length>0)throw alert("Your browser does not support the following features: "+X+".\nThe app will exit now."),new Error("Unsupported features: "+X);const V=document.getElementById("canvasMain"),H=V.getContext("2d");let J=!1;if(!H)throw alert("Unable to get canvas 2d context.\nThe app will exit now."),new Error("Unable to get canvas 2d context");const K=new class{constructor(t){this.ctx=t}clearLineDash(){this.ctx.setLineDash(t)}drawCircle(t,e,s,i,n){const o=this.x+this.width/2,r=this.y+this.height/2,a=s-o,h=i-r,l=this.radius;if(Math.sqrt(a*a+h*h)-n-e>l)return;if(Math.sqrt((s-o)*(s-o)+(i-r)*(i-r))+l+e<n)return;const c=this.ctx;c.strokeStyle=t,c.lineWidth=e,c.beginPath(),c.arc(s,i,n,0,2*Math.PI),c.stroke()}fillCircle(t,e,s,i){const n=e-(this.x+this.width/2),o=s-(this.y+this.height/2),r=this.radius;if(Math.sqrt(n*n+o*o)-i>r)return;const a=this.ctx;a.fillStyle=t,a.beginPath(),a.arc(e,s,i,0,2*Math.PI),a.fill()}drawLine(t,e,s,i,n,o){if(function(t,e,s,i,n,o){return(n-s)*(n-s)+(o-i)*(o-i)<1e-20?Math.sqrt((t-s)*(t-s)+(e-i)*(e-i)):Math.abs((n-s)*(i-e)-(s-t)*(o-i))/Math.sqrt((n-s)*(n-s)+(o-i)*(o-i))}(this.x+this.width/2,this.y+this.height/2,s,i,n,o)>this.radius+e)return;const r=this.ctx;r.strokeStyle=t,r.lineWidth=e,r.beginPath(),r.moveTo(s,i),r.lineTo(n,o),r.stroke()}}(H);function $(){const t=location.hash,e=t?new URLSearchParams(t.substring(1)):new URLSearchParams,s=e.get("zoom");B="dynamic"===s,J="manual"===s,J||"dynamic"===s||W(1);const i=e.get("seed");if(i)if("evergreen"===i)G(2);else if("daily"===i)G(1);else try{const t=9223372036854775807n,e=-9223372036854775808n;let s=BigInt(i);s>t&&(s=t),s<e&&(s=e),G(0),function(t){_=t}(s)}catch(t){console.log(t)}}$(),window.addEventListener("hashchange",$);const Q=function(t,e){const s=new z(new U,function(){switch(O){case 0:return Z(_);case 1:return Z(BigInt(function(){let t=new Date;return 1e4*t.getFullYear()+100*t.getMonth()+t.getDate()}()));default:return Z((BigInt(n.int())<<32n|BigInt(n.int()))%10000000n)}}()),i=new R;s.initRandom();const r=function(t,e){let s=q,i=0,n=0;return(o,r)=>{const a=o.canvas.width,l=o.canvas.height;if(o.fillStyle="#16161D",o.fillRect(0,0,a,l),B){const e=t.closestPlanetForZoom(),i=Math.max(0,t.ship.pos.distance(e.pos)-1.2*e.radius);s=h(500/i,N,5)}else s=q;{const e=t.follow;null!==e?(i=-e.pos.x,n=-e.pos.y):i=n=0}const c=a/s,d=l/s,p=-i-.5*c,u=-n-.5*d,f=p+c,m=u+d,g=p+c/2,y=u+d/2;let w=1e3;const x=j(32);for(;w*s<x;)w*=10;o.save(),o.scale(s,s),o.translate(.5*a/s-g,.5*l/s-y),r.x=p,r.y=u,r.width=c,r.height=d,r.radius=Math.sqrt((c*c+d*d)/4);var v=Math.floor(p/w)*w;for(o.strokeStyle="#292936";v<f;)o.lineWidth=(v%(10*w)==0?3:1.5)/s,o.beginPath(),o.moveTo(v,u),o.lineTo(v,m),o.stroke(),v+=w;for(var b=Math.floor(u/w)*w;b<m;)o.lineWidth=(b%(10*w)==0?3:1.5)/s,o.beginPath(),o.moveTo(p,b),o.lineTo(f,b),o.stroke(),b+=w;e.zoom=s,e.context=o,e.helper=r,e.drawUniverse(t),o.restore()}}(s,i),a=j(50),l=j(100),c=function(t,e,s,i){let n,o,r,a,h=!1;return{pointerInput:function(t){if(h)if("touchend"===t.type||"touchcancel"===t.type||"pointerup"===t.type||"pointercancel"===t.type)h=!1,i(0,0),t.preventDefault();else if("touchmove"===t.type){const e=t.touches[0];r=e.clientX*window.devicePixelRatio,a=e.clientY*window.devicePixelRatio,i(r-n,a-o),t.preventDefault()}else"pointermove"===t.type?(r=t.clientX*window.devicePixelRatio,a=t.clientY*window.devicePixelRatio,i(r-n,a-o),t.preventDefault()):"touchstart"===t.type&&t.touches.length>1&&(h=!1,i(0,0));else if("touchstart"===t.type){if(1===t.touches.length){const e=t.touches[0];n=r=e.clientX*window.devicePixelRatio,o=a=e.clientY*window.devicePixelRatio,h=!0,t.preventDefault()}}else"pointerdown"===t.type&&(n=r=t.clientX*window.devicePixelRatio,o=a=t.clientY*window.devicePixelRatio,h=!0,t.preventDefault(),t.target.setPointerCapture(t.pointerId))},draw:(s,i)=>{if(h){const h=r-n,l=a-o,c=Math.min(e,Math.sqrt(h*h+l*l)),d=Math.max(t,c),p=Math.atan2(l,h);if(s.strokeStyle="#00FF00",s.lineWidth=2,c<t){const t=window.visualViewport&&window.visualViewport.scale||1;s.setLineDash([t,2*t])}s.beginPath(),s.arc(n,o,d,0,2*Math.PI),s.stroke(),i.clearLineDash(),s.beginPath(),s.moveTo(n,o),s.lineTo(n+Math.cos(p)*c,o+Math.sin(p)*c),s.stroke()}}}}(a,l,0,(t,e)=>{if(s.follow instanceof P){const n=s.follow;if(0===t&&0===e)n.thrust.x=0,n.thrust.y=0;else{const s=Math.atan2(e,t);n.angle=s;const o=Math.sqrt(t*t+e*e);o<a?(n.thrust.x=0,n.thrust.y=0):f(n.thrust,s,h((o-(i=a))/(l-i),0,1))}}var i}),d=c.draw,p=function(t,e,s){let i=!1,n=!1,r=-1;const a=document.createTextNode("");e.appendChild(a);const h=document.createTextNode("");s.appendChild(h);let l=0,c=0,d=0;return p=>{if(-1===r)return void(r=p);let u=p-r;n||(u>=2e3?(s.hidden=!1,s.style.opacity=1,n=!0):u>1e3&&(s.hidden=!1,s.style.opacity=Math.random()*(p-1e3)/1e3)),i||(u>=3e3?(e.hidden=!1,e.style.opacity=String(1),i=!0):u>2e3&&(e.hidden=!1,e.style.opacity=String(Math.random()*(p-2e3)/1e3))),p-c>=1e3&&(d=1e3*l/(p-c),c=p,l=0),l++;const f=t.star,m=t.planets.filter(t=>t.explored).map(t=>"  BODY: "+t.name+"\n  TYPE: "+t.description+"\n  ATMO: "+t.atmosphere+"\n FAUNA: "+t.fauna+"\n FLORA: "+t.flora+"\n"),g="  STAR: "+f.name+" (UDC-"+t.randomSeed%100000n+")\n CLASS: "+S[f.cls]+"\nRADIUS: "+Math.floor(f.radius)+"\n"+(0,o.sprintf)("  MASS: %.3e\n",f.mass)+"BODIES: "+m.length+" / "+t.planets.length+"\n   FPS: "+d.toFixed(1)+"\n  vFPS: "+(1/t.dt).toFixed(0)+"\n\n"+m.join("\n");a.textContent=g;const y=t.ship,w=t.closestPlanet(),x=Math.floor(w.pos.distance(y.pos));let v="";null!==y.landing?v+="LND: "+y.landing.planet.name:x<1e4&&(v+="ALT: "+x),0===y.thrust.x&&0===y.thrust.y||(v.length>0&&(v+="\n"),v+="THR: "+(100*y.thrust.mag()).toFixed(0)+"%"),v.length>0&&(v+="\n"),v+="POS: "+y.pos.str()+"\n",v+="VEL: "+y.velocity.mag().toFixed(0),h.textContent=v}}(s,t,e);return{pointerInput:c.pointerInput,draw:(t,e,i)=>{s.simulateFrame(t),r(e,i),d(e,i),p(t)}}}(document.getElementById("topText"),document.getElementById("bottomText")),tt=Q.pointerInput,et=Q.draw;function st(t){et(t,H,K),requestAnimationFrame(st)}function it(){const t=V.getBoundingClientRect();V.width=Math.round(t.width*window.devicePixelRatio),V.height=Math.round(t.height*window.devicePixelRatio)}document.getElementById("loading").hidden=!0,V.hidden=!1,V.addEventListener("touchstart",tt),V.addEventListener("touchmove",tt),V.addEventListener("touchend",tt),V.addEventListener("touchcancel",tt),V.addEventListener("pointerdown",tt),V.addEventListener("pointermove",tt),V.addEventListener("pointerup",tt),V.addEventListener("pointercancel",tt);let nt=!1,ot=0,rt=0;function at(t){if(nt){if("touchstart"===t.type)2!==t.touches.length&&(nt=!1);else if("touchend"===t.type||"touchcancel"===t.type)nt=!1;else if("touchmove"===t.type){const e=t.touches[1].clientX-t.touches[0].clientX,s=t.touches[1].clientY-t.touches[0].clientY,i=Math.sqrt(e*e+s*s);J&&W(ot*i/rt),t.preventDefault()}}else if("touchstart"===t.type&&2===t.touches.length){nt=!0;const e=t.touches[1].clientX-t.touches[0].clientX,s=t.touches[1].clientY-t.touches[0].clientY;ot=Y(),rt=Math.sqrt(e*e+s*s),t.preventDefault()}}V.addEventListener("touchstart",at),V.addEventListener("touchmove",at),V.addEventListener("touchend",at),V.addEventListener("touchcancel",at),document.addEventListener("wheel",function(t){J&&(t.preventDefault(),W(Y()*(1-t.deltaY/1e3)))}),setTimeout(function(){it(),new ResizeObserver(it).observe(V),confirm("This project is licensed under the Apache License 2.0.\nThis project is not affiliated with Android or Google.\n\nClick OK to continue running this app, or click Cancel to close this app.")&&setTimeout(()=>requestAnimationFrame(st),0)},0)})()})();