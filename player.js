(()=>{"use strict";var t,e={3327(t,e,s){function i(t,e,s){return(s-t)/(e-t)}function n(t,e,s){return t<e?e:t>s?s:t}s.d(e,{Ac:()=>i,qE:()=>n}),Math.exp,Math.pow},4201(t,e,s){s.d(e,{B8:()=>E,Jx:()=>x,OP:()=>F,_D:()=>w,aw:()=>y,rm:()=>f,zd:()=>g});var i=s(3232),n=s(2079),o=s(3327),a=s(6409),r=s(4104),h=s(7730),l=s(9927);const c=Math.PI,d=Math.abs,p=Math.pow,u=Math.sqrt;class f extends a.nB{constructor(t,e,s,i,n="#FFFFFF"){super(),this.atmosphere="",this.description="",this.flora="",this.fauna="",this.explored=!1,this.orbitCenter=t,this.radius=e,this.pos=s,this.speed=i,this.color=n,this.orbitRadius=s.distance(t),this.mass=1*c*e*e*e*2.5}update(t,e){const s=(0,h.Pj)(this.pos,this.orbitCenter);(0,h.eP)(this.velocity,s+c/2,this.speed),super.update(t,e)}postUpdate(t,e){const s=(0,h.Pj)(this.pos,this.orbitCenter);(0,h.eP)(this.pos,s,this.orbitRadius),this.pos.x+=this.orbitCenter.x,this.pos.y+=this.orbitCenter.y,super.postUpdate(t,e)}}const m=Object.freeze([0,1,2,3,4,5,6]),g=Object.freeze(["O","B","A","F","G","K","M"]);class v extends f{constructor(t,e){super(h.ZY.Zero(),e,h.ZY.Zero(),0,function(t){switch(t){case 0:return"#6666FF";case 1:return"#CCCCFF";case 2:return"#EEEEFF";case 3:return"#FFFFFF";case 4:return"#FFFF66";case 5:return"#FFCC33";case 6:return"#FF8800"}}(t)),this.anim=0,this.cls=t,this.mass=1*c*p(e,3)*.5,this.collides=!1}update(t,e){this.anim+=e}}class w extends a.vR{constructor(t,e){super(e),this.latestDiscovery=null,this.planets=[],this.follow=null,this.ringfence=new a.mc(2e5),this.namer=t}initTest(){this.star=new v(2,8e3),this.star.name="TEST SYSTEM";for(let t=0;t<10;t++){const e=t/9,s=(0,n.C)(50,2e3,e),i=(0,n.C)(16e3,15e4,e),o=50*u(i*i*i/this.star.mass),a=2*c*i/o,r=new f(this.star.pos.copy(),s,(0,h.eP)(h.ZY.Zero(),e*c*2,i).addSelf(this.star.pos),a,"#A7A7CA");l.$&&console.log("Landroid","created planet",r,"with period",o,"and vel",a);const d=t+1;r.description="TEST PLANET #"+d,r.atmosphere="radius="+s,r.flora="mass="+r.mass,r.fauna="speed="+a,this.planets.push(r),this.addEntity(r)}this.planets.sort((t,e)=>t.pos.distance(this.star.pos)-e.pos.distance(this.star.pos)),this.planets.forEach((t,e)=>t.name="TEST SYSTEM "+(e+1)),this.addEntity(this.star),this.ship=new E,(0,h.eP)(this.ship.pos,c/4,16e3).addSelf(this.star.pos),this.ship.angle=0,this.addEntity(this.ship),this.ringfence.add(this.ship),this.addConstraint(this.ringfence),this.follow=this.ship}initRandom(){const t=this.namer.nameSystem(this.rngForInit);this.star=new v((0,r.Ho)(this.rngForInit,m),this.rngForInit.minmax(1e3,8e3)),this.star.name=t;for(let t=0,e=this.rngForInit.minmaxInt(1,11);t<e;t++){const t=this.rngForInit.minmax(50,2e3),e=(0,n.C)(16e3,15e4,this.rngForInit.float()),s=50*u(e*e*e/this.star.mass),i=2*c*e/s,o=new f(this.star.pos,t,(0,h.eP)(h.ZY.Zero(),this.rngForInit.float()*c*2,e).addSelf(this.star.pos),i,"#A7A7CA");l.$&&console.log("Landroid","created planet",o,"with period",s,"and vel",i),o.description=this.namer.describePlanet(this.rngForInit),o.atmosphere=this.namer.describeAtmo(this.rngForInit),o.flora=this.namer.describeLife(this.rngForInit),o.fauna=this.namer.describeLife(this.rngForInit),this.planets.push(o),this.addEntity(o)}this.planets.sort((t,e)=>t.pos.distance(this.star.pos)-e.pos.distance(this.star.pos)),this.planets.forEach((e,s)=>e.name=t+" "+(s+1)),this.addEntity(this.star),this.ship=new E,(0,h.eP)(this.ship.pos,this.rngForInit.float()*c*2,this.rngForInit.minmax(16e3,15e4)).addSelf(this.star.pos),this.ship.angle=this.rngForInit.float()*c*2,this.addEntity(this.ship),this.ringfence.add(this.ship),this.addConstraint(this.ringfence),this.follow=this.ship}updateAll(t,e){this.ship.transit=!1;const s=e=>{const s=e.pos.distance(this.ship.pos);s<e.radius?e instanceof v&&(this.ship.transit=!0):this.now>this.ship.launchClock+2&&(0,h.HX)(this.ship.velocity,(0,h.Pj)(e.pos,this.ship.pos),.01*t*(this.ship.mass*e.mass)/(s*s))};this.planets.forEach(s),s(this.star),super.updateAll(t,e)}closestPlanet(){const t=Array.from(this.planets);return t.push(this.star),t.map(t=>[t.pos,t]).sort((t,e)=>t[0].distance(this.ship.pos)-e[0].distance(this.ship.pos))[0][1]}closestPlanetForZoom(){const t=Array.from(this.planets);return t.push(this.star),t.map(t=>[t.pos,t]).sort((t,e)=>t[0].distance(this.ship.pos)-1.2*t[1].radius-(e[0].distance(this.ship.pos)-1.2*e[1].radius))[0][1]}solveAll(t,e){if(null===this.ship.landing){const t=this.closestPlanet();if(t.collides){const e=this.ship.pos.distance(t.pos)-this.ship.radius-t.radius,s=(0,h.Pj)(this.ship.pos,t.pos);if(e<0)if(this.ship.velocity.distance(t.velocity),d(this.ship.angle-s)<c/4){const e=new y(this.ship,t,s);this.ship.landing=e,(0,h.N7)(this.ship.velocity,t.velocity),this.addConstraint(e),t.explored=!0,this.latestDiscovery=t}else{const i=(0,h.eP)(h.ZY.Zero(),s,t.radius).addSelf(t.pos);(0,h.eP)(this.ship.pos,s,t.radius+this.ship.radius-e).addSelf(t.pos);for(let t=1;t<=10;t++){const t=new F(this.rng.minmax(.5,2),!1,0,x.DOT,"#FFFFFF",1);(0,h.eP)(t.pos,this.rng.minmax(0,2*c),this.rng.minmax(.1,.5)).addSelf(i),(0,h.N7)(t.opos,t.pos),(0,h.eP)(t.velocity,this.rng.minmax(0,2*c),this.rng.minmax(.1,.5)),t.velocity.x+=.8*this.ship.velocity.x,t.velocity.y+=.8*this.ship.velocity.y,this.addEntity(t)}}}}super.solveAll(t,e)}postUpdateAll(t,e){super.postUpdateAll(t,e),e.forEach(t=>{t.canBeRemoved&&t.canBeRemoved()&&e.delete(t)})}}class y{constructor(t,e,s){this.ship=t,this.planet=e,this.angle=s,this.landingVector=(0,h.eP)(h.ZY.Zero(),s,t.radius+e.radius)}solve(t,e){null!==this.ship&&(this.ship.pos.x=0*this.ship.pos.x+1*(this.planet.pos.x+this.landingVector.x),this.ship.pos.y=0*this.ship.pos.y+1*(this.planet.pos.y+this.landingVector.y),this.ship.angle=this.angle)}}var x;!function(t){t[t.LINE=0]="LINE",t[t.LINE_ABSOLUTE=1]="LINE_ABSOLUTE",t[t.DOT=2]="DOT",t[t.DOT_ABSOLUTE=3]="DOT_ABSOLUTE",t[t.RING=4]="RING"}(x||(x={}));class F extends a.nB{constructor(t,e=!1,s=0,i=x.LINE,n="#888888",o=2){super(),this.lifetime=t,this.collides=e,this.mass=s,this.style=i,this.color=n,this.size=o}update(t,e){super.update(t,e),this.lifetime-=e}canBeRemoved(){return this.lifetime<0}postUpdate(t,e){}}class P{constructor(){this.positions=new i.J(1e4),this.angles=new i.J(1e4)}add(t,e,s){this.positions.size()>=9999&&(this.positions.removeFirst(),this.angles.removeFirst(),this.positions.removeFirst(),this.angles.removeFirst()),this.positions.addLast(new h.ZY(t,e)),this.angles.addLast(s)}}class E extends a.nB{constructor(){super(),this.thrust=h.ZY.Zero(),this.launchClock=0,this.transit=!1,this.track=new P,this.landing=null,this.mass=10,this.radius=12}update(t,e){const s=this.thrust.mag();if(s>0){let i=1e3*e;i*=(0,o.qE)(s,0,1),null===this.landing||(0===this.launchClock&&(this.launchClock=t.now+1),t.now>this.launchClock?(t.removeConstraint(this.landing),this.landing=null):i=0),(0,h.HX)(this.velocity,this.angle,i)}else 0!==this.launchClock&&(this.launchClock=0);this.velocity.mag()>5e3&&(0,h.eP)(this.velocity,this.velocity.angle(),5e3),super.update(t,e)}postUpdate(t,e){super.postUpdate(t,e),this.track.add(this.pos.x,this.pos.y,this.angle);const s=this.thrust.mag();if(t.rng.float()<s){const i=new F(t.rng.minmax(.5,1),!0,1,x.RING,"rgba(255,255,255,0.25)",3);(0,h.N7)(i.pos,this.pos),(0,h.N7)(i.opos,this.opos),(0,h.N7)(i.velocity,this.velocity),(0,h.HX)(i.velocity,this.angle+t.rng.minmax(-.2,.2),-1e3*s*10*e),t.addEntity(i)}}}},4438(t,e,s){const i=[],n=Math.PI,o=Math.abs,a=Math.sqrt;function r(t,e,s,i,n,r){return(n-s)*(n-s)+(r-i)*(r-i)<1e-20?a((t-s)*(t-s)+(e-i)*(e-i)):o((n-s)*(i-e)-(s-t)*(r-i))/a((n-s)*(n-s)+(r-i)*(r-i))}var h=s(963),l=s(7604),c=s(4201),d=s(6725),p=s(9059),u=s(7730),f=s(3327);let m=1,g=5038n;const v=.00125;let w=!1,y=1,x="";const F=Math.PI,P=Math.atan2,E=Math.cos,I=Math.floor,T=Math.max,b=Math.min,L=Math.random,S=Math.sin,C=Math.sqrt;function A(t){return t>=0||-9223372036854775808n===t?t:-t}function R(t){return t*window.devicePixelRatio}function M(){return y}function D(t){y=(0,f.qE)(t,v,5)}function O(t){m=t}const k=[];if("undefined"==typeof BigInt&&k.push("BigInt"),void 0===String.prototype.matchAll&&k.push("String.prototype.matchAll"),k.length>0)throw alert("Your browser does not support the following features: "+k+".\nThe app will exit now."),new Error("Unsupported features: "+k);const B=document.getElementById("canvasMain"),Y=B.getContext("2d");let U=!1;if(!Y)throw alert("Unable to get canvas 2d context.\nThe app will exit now."),new Error("Unable to get canvas 2d context");const N=new class{constructor(t){this.ctx=t}clearLineDash(){this.ctx.setLineDash(i)}drawCircle(t,e,s,i,o){const r=this.x+this.width/2,h=this.y+this.height/2,l=s-r,c=i-h,d=this.radius;if(a(l*l+c*c)-o-e>d)return;if(a((s-r)*(s-r)+(i-h)*(i-h))+d+e<o)return;const p=this.ctx;p.strokeStyle=t,p.lineWidth=e,p.beginPath(),p.arc(s,i,o,0,2*n),p.stroke()}fillCircle(t,e,s,i){const o=e-(this.x+this.width/2),r=s-(this.y+this.height/2),h=this.radius;if(a(o*o+r*r)-i>h)return;const l=this.ctx;l.fillStyle=t,l.beginPath(),l.arc(e,s,i,0,2*n),l.fill()}mayDrawLine(t,e,s,i,n){return r(this.x+this.width/2,this.y+this.height/2,e,s,i,n)<=this.radius+t}drawLine(t,e,s,i,n,o){if(r(this.x+this.width/2,this.y+this.height/2,s,i,n,o)>this.radius+e)return;const a=this.ctx;a.strokeStyle=t,a.lineWidth=e,a.beginPath(),a.moveTo(s,i),a.lineTo(n,o),a.stroke()}}(Y);function Z(){const t=location.hash,e=t?new URLSearchParams(t.substring(1)):new URLSearchParams,s=e.get("zoom");w="dynamic"===s,U="manual"===s,U||"dynamic"===s||D(1);const i=e.get("seed");if(i)if("evergreen"===i)O(2);else if("daily"===i)O(1);else try{const t=9223372036854775807n,e=-9223372036854775808n;let s=BigInt(i);s>t&&(s=t),s<e&&(s=e),O(0),function(t){g=t}(s)}catch(t){console.error(t)}}Z(),window.addEventListener("hashchange",Z);const q=function(t,e){const s=new d.G(new p.m,function(){switch(m){case 0:return A(g);case 1:return A(BigInt(function(){let t=new Date;return 1e4*t.getFullYear()+100*t.getMonth()+t.getDate()}()));default:return A((BigInt(h.I.int())<<32n|BigInt(h.I.int()))%10000000n)}}()),i=new d.l;s.initRandom(),x=(0,l.sprintf)("  MASS: %.3e\n",s.star.mass);const n=function(t,e){let s=y,i=0,n=0;return(o,a)=>{const r=o.canvas.width,h=o.canvas.height;if(o.fillStyle="#16161D",o.fillRect(0,0,r,h),w){const e=t.closestPlanetForZoom(),i=T(0,t.ship.pos.distance(e.pos)-1.2*e.radius);s=(0,f.qE)(500/i,v,5)}else s=y;{const e=t.follow;null!==e?(i=-e.pos.x,n=-e.pos.y):i=n=0}const l=r/s,c=h/s,d=-i-.5*l,p=-n-.5*c,u=d+l,m=p+c,g=d+l/2,x=p+c/2;let F=1e3;const P=R(32);for(;F*s<P;)F*=10;o.save(),o.scale(s,s),o.translate(.5*r/s-g,.5*h/s-x),a.x=d,a.y=p,a.width=l,a.height=c,a.radius=C((l*l+c*c)/4);var E=I(d/F)*F;for(o.strokeStyle="#292936";E<u;)o.lineWidth=(E%(10*F)==0?3:1.5)/s,o.beginPath(),o.moveTo(E,p),o.lineTo(E,m),o.stroke(),E+=F;for(var b=I(p/F)*F;b<m;)o.lineWidth=(b%(10*F)==0?3:1.5)/s,o.beginPath(),o.moveTo(d,b),o.lineTo(u,b),o.stroke(),b+=F;e.zoom=s,e.context=o,e.helper=a,e.drawUniverse(t),o.restore()}}(s,i),o=R(50),a=R(100),r=function(t,e,s,i){let n,o,a,r,h=!1;return{pointerInput:function(t){if(h)if("touchend"===t.type||"touchcancel"===t.type||"pointerup"===t.type||"pointercancel"===t.type||"dblclick"===t.type)h=!1,i(0,0),t.preventDefault();else if("touchmove"===t.type){const e=t.touches[0];a=e.clientX*window.devicePixelRatio,r=e.clientY*window.devicePixelRatio,i(a-n,r-o),t.preventDefault()}else"pointermove"===t.type?(a=t.clientX*window.devicePixelRatio,r=t.clientY*window.devicePixelRatio,i(a-n,r-o),t.preventDefault()):"touchstart"===t.type&&t.touches.length>1&&(h=!1,i(0,0));else if("touchstart"===t.type){if(1===t.touches.length){const e=t.touches[0];n=a=e.clientX*window.devicePixelRatio,o=r=e.clientY*window.devicePixelRatio,h=!0,t.preventDefault()}}else"pointerdown"===t.type?(n=a=t.clientX*window.devicePixelRatio,o=r=t.clientY*window.devicePixelRatio,h=!0,t.preventDefault(),t.target.setPointerCapture(t.pointerId)):"dblclick"===t.type&&(n=a=t.clientX*window.devicePixelRatio,o=r=t.clientY*window.devicePixelRatio,h=!0)},draw:(s,i)=>{if(h){const h=a-n,l=r-o,c=b(e,C(h*h+l*l)),d=T(t,c),p=P(l,h);if(s.strokeStyle="#00FF00",s.lineWidth=2,c<t){const t=window.devicePixelRatio;s.setLineDash([t,2*t])}s.beginPath(),s.arc(n,o,d,0,2*F),s.stroke(),i.clearLineDash(),s.beginPath(),s.moveTo(n,o),s.lineTo(n+E(p)*c,o+S(p)*c),s.stroke()}}}}(o,a,0,(t,e)=>{if(s.follow instanceof c.B8){const i=s.follow;if(0===t&&0===e)i.thrust.x=0,i.thrust.y=0;else{const s=P(e,t);i.angle=s;const n=C(t*t+e*e);n<o?(i.thrust.x=0,i.thrust.y=0):(0,u.eP)(i.thrust,s,(0,f.qE)((0,f.Ac)(o,a,n),0,1))}}}),M=r.draw,D=function(t,e,s){let i=!1,n=!1,o=-1;const a=document.createTextNode("");e.appendChild(a);const r=document.createTextNode("");s.appendChild(r);let h=0,l=0,d=0,p=0,u=0;return f=>{if(-1===o)return void(o=f);let m=f-o;n||(m>=2e3?(s.hidden=!1,s.style.opacity=1,n=!0):m>1e3&&(s.hidden=!1,s.style.opacity=L()*(f-1e3)/1e3)),i||(m>=3e3?(e.hidden=!1,e.style.opacity=String(1),i=!0):m>2e3&&(e.hidden=!1,e.style.opacity=String(L()*(f-2e3)/1e3))),f-d>=1e3&&(p=1e3*h/(f-d),u=h/l,d=f,h=0,l=0),h++,l+=t.dt;const g=t.star,v=t.planets.filter(t=>t.explored).map(t=>"  BODY: "+t.name+"\n  TYPE: "+t.description+"\n  ATMO: "+t.atmosphere+"\n FAUNA: "+t.fauna+"\n FLORA: "+t.flora+"\n"),w="  STAR: "+g.name+" (UDC-"+t.randomSeed%100000n+")\n CLASS: "+c.zd[g.cls]+"\nRADIUS: "+I(g.radius)+"\n"+x+"BODIES: "+v.length+" / "+t.planets.length+"\n   FPS: "+p.toFixed(1)+"\n  vFPS: "+u.toFixed(1)+"\n\n"+v.join("\n");a.textContent=w;const y=t.ship,F=t.closestPlanet(),P=I(F.pos.distance(y.pos));let E="";null!==y.landing?E+="LND: "+y.landing.planet.name:P<1e4&&(E+="ALT: "+P),0===y.thrust.x&&0===y.thrust.y||(E.length>0&&(E+="\n"),E+="THR: "+(100*y.thrust.mag()).toFixed(0)+"%"),E.length>0&&(E+="\n"),E+="POS: "+y.pos.str()+"\n",E+="VEL: "+y.velocity.mag().toFixed(0),r.textContent=E}}(s,t,e);return{pointerInput:r.pointerInput,draw:(t,e,i)=>{s.simulateFrame(t),n(e,i),M(e,i),D(t)}}}(document.getElementById("topText"),document.getElementById("bottomText")),X=q.pointerInput,j=q.draw;function z(t){j(t,Y,N),requestAnimationFrame(z)}function _(){const t=B.getBoundingClientRect();B.width=Math.round(t.width*window.devicePixelRatio),B.height=Math.round(t.height*window.devicePixelRatio)}document.getElementById("loading").hidden=!0,B.hidden=!1,B.addEventListener("touchstart",X),B.addEventListener("touchmove",X),B.addEventListener("touchend",X),B.addEventListener("touchcancel",X),B.addEventListener("pointerdown",X),B.addEventListener("pointermove",X),B.addEventListener("pointerup",X),B.addEventListener("pointercancel",X),B.addEventListener("dblclick",X);let G=!1,H=0,W=0;function V(t){if(G){if("touchstart"===t.type)2!==t.touches.length&&(G=!1);else if("touchend"===t.type||"touchcancel"===t.type)G=!1;else if("touchmove"===t.type){const e=t.touches[1].clientX-t.touches[0].clientX,s=t.touches[1].clientY-t.touches[0].clientY,i=Math.sqrt(e*e+s*s);U&&D(H*i/W),t.preventDefault()}}else if("touchstart"===t.type&&2===t.touches.length){G=!0;const e=t.touches[1].clientX-t.touches[0].clientX,s=t.touches[1].clientY-t.touches[0].clientY;H=M(),W=Math.sqrt(e*e+s*s),t.preventDefault()}}B.addEventListener("touchstart",V),B.addEventListener("touchmove",V),B.addEventListener("touchend",V),B.addEventListener("touchcancel",V),document.addEventListener("wheel",function(t){U&&D(M()*(1-t.deltaY/1e3))}),setTimeout(function(){_(),new ResizeObserver(_).observe(B),requestAnimationFrame(z)},0)},4666(t,e,s){s.d(e,{$1:()=>h,DT:()=>r,N6:()=>a});const i=Math.PI,n=Math.cos,o=Math.sin;function a(t,e,s,a){const r=new Path2D;r.moveTo(t+s,a);const h=2*i/e;for(let i=1;i<e;i++)r.lineTo(t*n(h*i)+s,t*o(h*i)+a);return r.closePath(),r}function r(t,e,s){const a=new Path2D,r=2*i/s;a.moveTo(t,0),a.lineTo(e*n(.5*r),e*o(.5*r));for(let i=1;i<s;i++)a.lineTo(t*n(r*i),t*o(r*i)),a.lineTo(e*n(r*(i+.5)),e*o(r*(i+.5)));return a.closePath(),a}const h=t=>new Path2D(t)},9927(t,e,s){s.d(e,{$:()=>i});let i=!0}},s={};function i(t){var n=s[t];if(void 0!==n)return n.exports;var o=s[t]={exports:{}};return e[t](o,o.exports,i),o.exports}i.m=e,t=[],i.O=(e,s,n,o)=>{if(!s){var a=1/0;for(c=0;c<t.length;c++){for(var[s,n,o]=t[c],r=!0,h=0;h<s.length;h++)(!1&o||a>=o)&&Object.keys(i.O).every(t=>i.O[t](s[h]))?s.splice(h--,1):(r=!1,o<a&&(a=o));if(r){t.splice(c--,1);var l=n();void 0!==l&&(e=l)}}return e}o=o||0;for(var c=t.length;c>0&&t[c-1][2]>o;c--)t[c]=t[c-1];t[c]=[s,n,o]},i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={88:0};i.O.j=e=>0===t[e];var e=(e,s)=>{var n,o,[a,r,h]=s,l=0;if(a.some(e=>0!==t[e])){for(n in r)i.o(r,n)&&(i.m[n]=r[n]);if(h)var c=h(i)}for(e&&e(s);l<a.length;l++)o=a[l],i.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return i.O(c)},s=self.webpackChunklandroid_web=self.webpackChunklandroid_web||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))})();var n=i.O(void 0,[36,725],()=>i(4438));n=i.O(n)})();